(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[57],{a6fa:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",{staticClass:"q-gutter-y-md",attrs:{padding:""}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.delivery_today_pending.length,expression:"delivery_today_pending.length"}]},[s("div",{staticClass:"text-h6 q-px-xs text-subtitle1"},[e._v("Today Deliverable Orders")]),s("RemoteTokensList",{attrs:{name:"dpo",tokens:e.delivery_today_pending,customers:e.customers,items:e.items,kitchens:e.kitchens}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.delivery_past_pending.length,expression:"delivery_past_pending.length"}]},[s("div",{staticClass:"text-h6 q-px-xs text-subtitle1"},[e._v("Pending Past Orders")]),s("RemoteTokensList",{attrs:{name:"dpp",tokens:e.delivery_past_pending,customers:e.customers,items:e.items,kitchens:e.kitchens}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.delivery_tomorrow.length,expression:"delivery_tomorrow.length"}]},[s("div",{staticClass:"text-h6 q-px-xs text-subtitle1"},[e._v("Tomorrow Deliverable Orders")]),s("RemoteTokensList",{attrs:{name:"tdo",tokens:e.delivery_tomorrow,customers:e.customers,items:e.items,kitchens:e.kitchens}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.delivery_upcoming.length,expression:"delivery_upcoming.length"}]},[s("div",{staticClass:"text-h6 q-px-xs text-subtitle1"},[e._v("Upcoming Orders")]),s("RemoteTokensList",{attrs:{name:"dup",tokens:e.delivery_upcoming,customers:e.customers,items:e.items,kitchens:e.kitchens}})],1),s("transition",{attrs:{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[s("q-page-sticky",{directives:[{name:"show",rawName:"v-show",value:e.fab||!e.orders.length,expression:"fab || !orders.length"}],attrs:{position:"bottom-right",offset:e.offset}},[s("q-fab",{directives:[{name:"touch-pan",rawName:"v-touch-pan.prevent.mouse",value:e.move,expression:"move",modifiers:{prevent:!0,mouse:!0}}],attrs:{icon:"add",color:"primary",glossy:"",to:{name:"orders_remote_new"}}})],1)],1)],1)},a=[],i=s("ded3"),n=s.n(i),o=s("2f62"),c=s("b1c1"),l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-list",{staticClass:"rounded-borders",attrs:{bordered:""}},e._l(e.tokens,(function(t){return s("q-expansion-item",{key:e.hKey(e.name,t),attrs:{group:e.name,"switch-toggle-side":""},scopedSlots:e._u([{key:"header",fn:function(){return[s("q-item-section",[t.customer?s("q-item-label",[e._v(e._s(e.customers[parseInt(t.customer)].name))]):e._e(),s("q-item-label",{attrs:{caption:""}},[e._v(e._s(t.date_human))])],1),s("q-item-section",{attrs:{side:""}},[s("q-badge",{staticClass:"q-px-sm q-py-sm",attrs:{color:e.tpc[t.progress],label:t.progress}})],1)]},proxy:!0}],null,!0)},[s("q-card",{staticClass:"bg-grey-1"},[s("q-card-section",{staticClass:"q-py-xs"},[s("RemoteTokenItemsList",{attrs:{token:t,items:t.items,item_master:e.items,kitchen_master:e.kitchens,customer_master:e.customers}})],1)],1)],1)})),1)},d=[],m=s("232e"),p=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-list",{attrs:{separator:""}},[e._l(e.items,(function(t){return s("q-item",{key:e.hKey("roti",t)},[s("q-item-section",{attrs:{avatar:""}},[s("q-avatar",{attrs:{square:""}},[s("img",{attrs:{src:e.image(e.item_master[t.item].image)}})])],1),s("q-item-section",[s("q-item-label",[e._v(e._s(t.quantity)+" x "+e._s(e.item_master[t.item].name))]),s("q-item-label",{attrs:{caption:""}},[e._v("Delivery On: "+e._s(t.deliver_human))]),t.kitchen?s("q-item-label",{attrs:{caption:""}},[e._v("Kitchen: "+e._s(e.kitchen_master[t.kitchen].name))]):e._e(),s("q-item-label",{attrs:{caption:""}},[e._v("\n        Read Ref:\n        "),e.read_refs&&e.read_refs.hasOwnProperty(t.id)&&e.read_refs[t.id]?s("q-btn",{attrs:{label:e.read_refs[t.id],size:"sm",padding:"none",color:"light-blue",flat:"",dense:""},on:{click:function(s){return e.readRef(t)}}}):s("q-btn",{attrs:{label:"Add Read Reference",size:"sm",padding:"none",color:"light-blue",flat:"",dense:""},on:{click:function(s){return e.rRef(t)}}})],1)],1),s("q-item-section",{attrs:{side:""}},[s("q-badge",{staticClass:"q-px-sm q-py-xs",attrs:{color:e.tipc[t.progress],label:t.progress}})],1),e.cancelable.includes(t.progress)?s("q-item-section",{attrs:{side:""}},[s("q-btn",{attrs:{icon:"close",color:"red",dense:"",round:"",size:"sm"},on:{click:function(s){return e.cancel(t,!1)}}})],1):e._e(),e.serve_able.includes(t.progress)?s("q-item-section",{attrs:{side:""}},[s("q-btn",{attrs:{icon:"how_to_reg",color:"positive",dense:"",round:"",size:"sm"},on:{click:function(s){return e.serve(t,!1)}}})],1):e._e()],1)})),s("q-dialog",{attrs:{value:!!e.confirm,persistent:""},on:{"before-hide":function(t){e.confirm=!1}}},[e.confirm?s("q-card",[s("q-card-section",{staticClass:"text-white",class:"bg-"+e.property[e.prop][0]},[s("div",{staticClass:"text-h6"},[e._v("Are you sure???")]),s("div",[e._v(e._s(e.property[e.prop][1]))])]),s("q-card-section",[s("q-list",{attrs:{dense:"",separator:""}},[s("q-item",{attrs:{clickable:""}},[s("q-item-section",[e._v("Customer")]),s("q-item-section",{staticClass:"text-bold text-red",attrs:{side:""}},[e._v(e._s(e.customer_master[e.confirm.customer].name))])],1),s("q-item",{attrs:{clickable:""}},[s("q-item-section",[e._v("Token ID")]),s("q-item-section",{staticClass:"text-bold text-red",attrs:{side:""}},[e._v(e._s(e.confirm.token))])],1),s("q-item",{attrs:{clickable:""}},[s("q-item-section",[e._v("Order Date")]),s("q-item-section",{staticClass:"text-bold text-red",attrs:{side:""}},[e._v(e._s(e.confirm.date_human))])],1),s("q-item",{attrs:{clickable:""}},[s("q-item-section",[e._v("Deliver Date")]),s("q-item-section",{staticClass:"text-bold text-red",attrs:{side:""}},[e._v(e._s(e.confirm.deliver))])],1),s("q-item",{attrs:{clickable:""}},[s("q-item-section",[e._v("Item Name")]),s("q-item-section",{staticClass:"text-bold text-red",attrs:{side:""}},[e._v(e._s(e.item_master[e.confirm.item].name))])],1),s("q-item",{attrs:{clickable:""}},[s("q-item-section",[e._v("Item Quantity")]),s("q-item-section",{staticClass:"text-bold text-red",attrs:{side:""}},[e._v(e._s(e.confirm.quantity)+" ")])],1)],1)],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Cancel",color:"primary"}}),s("q-btn",{staticClass:"q-px-md",attrs:{loading:e.loading,color:e.property[e.prop][0],label:"Yes, Proceed"},on:{click:function(t){"cancel"===e.prop?e.cancel(e.confirm,!0):e.serve(e.confirm,!0)}}})],1)],1):e._e()],1),s("q-dialog",{attrs:{persistent:""},model:{value:e.add_ref,callback:function(t){e.add_ref=t},expression:"add_ref"}},[s("q-card",{staticStyle:{width:"22rem"}},[s("q-bar",{staticClass:"bg-teal text-white"},[s("span",{staticClass:"text-caption"},[e._v("Add Read Reference")]),s("q-space"),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),s("q-card-section",{staticClass:"q-gutter-y-sm"},[s("q-input",{attrs:{outlined:"",label:"Reference"},model:{value:e.r_ref,callback:function(t){e.r_ref=t},expression:"r_ref"}})],1),s("q-card-actions",{staticClass:"q-px-md q-pt-none",attrs:{align:"right"}},[s("q-btn",{staticClass:"q-px-md",attrs:{color:"teal",push:"",label:"Add",loading:e.loading},on:{click:e.addRef}})],1)],1)],1),s("q-dialog",{attrs:{persistent:""},model:{value:e.view_read_ref,callback:function(t){e.view_read_ref=t},expression:"view_read_ref"}},[e.view_read_ref&&e.r_ref_id?s("ReadReferenceCard",{staticStyle:{width:"22rem"},attrs:{id:e.r_ref_id}}):e._e()],1)],2)},u=[],f=(s("4d90"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-card",[s("q-bar",{staticClass:"text-grey-1",class:"bg-"+e.color+"-7"},[s("span",{staticClass:"text-caption"},[e._v("Read Reference")]),s("q-space"),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",dense:""}})],1),e.reference?[s("q-card-section",{staticClass:"q-pb-none row items-center q-col-gutter-x-xs"},[s("span",{staticClass:"text-h6 text-bold",class:"text-"+e.color},[e._v(e._s(e.r_ref))]),s("q-space"),s("q-input",{staticClass:"col",attrs:{outlined:"",readonly:"","input-class":"text-"+e.color,label:"Location",value:e.reference.token_source_location}}),s("q-input",{staticClass:"col",attrs:{outlined:"",readonly:"","input-class":"text-"+e.color,label:"ID",value:e.reference.token_item_source_id}})],1),s("q-card-section",{staticClass:"q-gutter-y-xs q-py-xs"},[s("div",{staticClass:"row q-col-gutter-x-xs"},[s("q-input",{staticClass:"col",attrs:{outlined:"",readonly:"","input-class":"text-"+e.color,label:"Item",value:e.reference.server[1].item}}),s("q-input",{staticClass:"col",attrs:{outlined:"",readonly:"","input-class":"text-"+e.color,label:"Quantity",value:e.reference.server[1].quantity}})],1),s("q-input",{attrs:{outlined:"",readonly:"","input-class":"text-"+e.color,label:"Delivery",value:e.reference.server[1].deliver}}),s("q-input",{staticStyle:{height:"6rem"},attrs:{outlined:"",readonly:"","input-class":"text-"+e.color,label:"Narration",value:e.reference.server[1].narration,type:"textarea"}})],1),s("q-card-actions",{staticClass:"q-px-md q-pt-none",attrs:{align:"right"}},[s("q-btn",{attrs:{label:"download",color:e.color,glossy:"",padding:"sm xl"},on:{click:e.download}})],1)]:s("q-card-section",{staticClass:"text-h6 text-center "},[e._v("No Read Reference")])],2)}),v=[],h=s("a357"),g={name:"ReadReferenceCard",props:["id"],data(){return{color:"light-blue"}},computed:{r_ref(){return _.get(_.find(this.$store.state.remote.data,{item:"token_items",local_id:parseInt(this.id)}),["extra","r_ref"])},reference(){return this.id?this.$store.getters["remote/read_reference"](this.id,{name:this.r_ref}):null}},methods:{download(){Object(h["a"])(this.r_ref+".JSON",JSON.stringify(this.reference),"application/json")}}},b=g,q=s("2877"),x=s("f09f"),k=s("d847"),y=s("2c91"),C=s("9c40"),w=s("a370"),R=s("27f9"),Q=s("4b7e"),I=s("7f67"),O=s("eebe"),j=s.n(O),N=Object(q["a"])(b,f,v,!1,null,null,null),T=N.exports;j()(N,"components",{QCard:x["a"],QBar:k["a"],QSpace:y["a"],QBtn:C["a"],QCardSection:w["a"],QInput:R["a"],QCardActions:Q["a"]}),j()(N,"directives",{ClosePopup:I["a"]});var S={name:"RemoteTokenItemsList",components:{ReadReferenceCard:T},props:["token","items","item_master","kitchen_master","customer_master"],data(){return{tipc:m["TokenItemProgressColor"],cancelable:["New","Accepted"],serve_able:["Completed"],confirm:!1,prop:"",loading:!1,property:{cancel:["red","You are about to cancel an item of remote order"],serve:["positive","You are about to serve an item of remote order"]},add_ref:!1,r_ref:"",r_ref_id:null,view_read_ref:!1}},computed:{ti_ids(){return _.map(this.items,(({id:e})=>parseInt(e)))},read_refs(){return _(this.$store.state.remote.data).filter((({item:e,local_id:t})=>"token_items"===e&&this.ti_ids.includes(parseInt(t)))).mapKeys((({local_id:e})=>parseInt(e))).mapValues((({extra:e})=>_.get(e,"r_ref"))).value()},ti_kitchens(){return _(this.items).mapKeys((({id:e})=>parseInt(e))).mapValues((({item:e})=>_.findKey(this.$store.state.kitchens.items,(t=>_.find(t,["item",e]))))).mapValues(_.toInteger).value()}},methods:{hKey(e,{id:t}){return Object(c["d"])(e,t)},image(e){return Object(c["g"])(e)},cancel(e,t){if(this.prop="cancel",!t)return this.confirm=Object.assign({},this.token,e,{token:this.token.id});this.loading=!0;let s=this;post("token","cancel",{id:e.id}).then((()=>s.confirm=!1)).catch().then((()=>this.loading=!1))},serve(e,t){if(this.prop="serve",!t)return this.confirm=Object.assign({},this.token,e,{token:this.token.id});this.loading=!0;let s=this;post("token","served",{id:e.id}).then((()=>s.confirm=!1)).catch().then((()=>this.loading=!1))},remote(e){return _.find(this.$store.state.remote.data,{item:"token_items",local_id:parseInt(e)})},rRef({id:e}){this.r_ref=_BRANCH+"TI"+_.padStart(e,6,"0"),this.r_ref_id=parseInt(e),this.add_ref=!0},addRef(){let e=_.get(this.remote(this.r_ref_id),"id"),t=this.r_ref,s=this.ti_kitchens[this.r_ref_id],r=this;if(this.loading=!0,!e||!t||!s)return this.loading=!1;post("remote","readReference",{id:e,reference:t,kitchen:s}).then((()=>r.add_ref=r.loading=!1))},readRef({id:e}){this.r_ref_id=parseInt(e),this.view_read_ref=!0}}},L=S,P=s("1c1c"),D=s("66e5"),A=s("4074"),$=s("cb32"),B=s("0170"),K=s("58a8"),Y=s("24e8"),E=Object(q["a"])(L,p,u,!1,null,null,null),z=E.exports;j()(E,"components",{QList:P["a"],QItem:D["a"],QItemSection:A["a"],QAvatar:$["a"],QItemLabel:B["a"],QBtn:C["a"],QBadge:K["a"],QDialog:Y["a"],QCard:x["a"],QCardSection:w["a"],QCardActions:Q["a"],QBar:k["a"],QSpace:y["a"],QInput:R["a"]}),j()(E,"directives",{ClosePopup:I["a"]});var J={name:"RemoteTokensList",components:{RemoteTokenItemsList:z},props:["name","tokens","customers","items","kitchens"],data(){return{tpc:m["TokenProgressColor"]}},methods:{hKey(e,{id:t}){return Object(c["d"])(e,t)}}},H=J,V=s("3b73"),M=Object(q["a"])(H,l,d,!1,null,null,null),F=M.exports;j()(M,"components",{QList:P["a"],QExpansionItem:V["a"],QItemSection:A["a"],QItemLabel:B["a"],QBadge:K["a"],QCard:x["a"],QCardSection:w["a"]});var U={name:"PageRemoteOrders",components:{RemoteTokensList:F},data(){return{fab:!0,offset:[24,24]}},computed:n()(n()(n()({},Object(o["d"])({customers:e=>e.customers.data,items:e=>e.items.data,kitchens:e=>e.kitchens.data})),Object(o["b"])({orders:"tokens/remote"})),{},{delivery_today_pending(){return _.filter(this.orders,(({items:e})=>_.some(e,(({deliver:e,progress:t})=>Object(c["l"])(e)&&G({progress:t})))))},delivery_past_pending(){return _.filter(this.orders,(({items:e})=>_.some(e,(({deliver:e,progress:t})=>Object(c["k"])(e,8)&&G({progress:t})))))},delivery_tomorrow(){return _.filter(this.orders,(({items:e})=>_.some(e,(({deliver:e,progress:t})=>Object(c["m"])(e)&&G({progress:t})))))},delivery_upcoming(){return _(this.orders).filter((({items:e})=>_.some(e,(({deliver:e})=>Object(c["j"])(e,365)&&!Object(c["m"])(e))))).sortBy(W).value()}}),methods:{move(e){this.offset=[this.offset[0]-e.delta.x,this.offset[1]-e.delta.y]}}};function G({progress:e}){return["New","Processing","Accepted"].includes(e)}function W({items:e}){return _(e).map((({deliver:e})=>Object(c["c"])(e,"YYYY-MM-DD HH:mm:ss").getTime())).min()}var X=U,Z=s("9989"),ee=s("de5e"),te=s("c294"),se=s("75c3"),re=Object(q["a"])(X,r,a,!1,null,null,null);t["default"]=re.exports;j()(re,"components",{QPage:Z["a"],QPageSticky:ee["a"],QFab:te["a"]}),j()(re,"directives",{TouchPan:se["a"]})}}]);