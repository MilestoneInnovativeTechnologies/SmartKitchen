(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[41],{"5f49":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{attrs:{padding:""}},[s("Masonry",{attrs:{width:"300",items:t.tokens},scopedSlots:t._u([{key:"item",fn:function(t){return[s("TokenDetailCard",{attrs:{id:t.id}})]}}])})],1)},a=[],n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-card",[s("q-card-section",{staticClass:"bg-info q-pa-xs"}),s("q-card-section",{staticClass:"q-py-sm bg-grey-2 row justify-between text-bold"},[s("div",[t._v("ID: "+t._s(t.token.id))]),s("div",[t._v(t._s(t.time))])]),s("q-card-section",[s("div",{staticClass:"row justify-between"},[s("div",{staticClass:"text-caption text-bold"},[t._v("Type")]),s("div",{staticClass:"text-bold"},[t._v(t._s(t.token.type))])]),t.seating?s("div",{staticClass:"row justify-between"},[s("div",{staticClass:"text-caption text-bold"},[t._v("Seating")]),s("div",{staticClass:"text-bold"},[t._v(t._s(t.seating.name))])]):t._e(),t.user?s("div",{staticClass:"row justify-between"},[s("div",{staticClass:"text-caption text-bold"},[t._v("User")]),s("div",{staticClass:"text-bold"},[t._v(t._s(t.user.name))])]):t._e(),t.seating||t.user?s("q-separator",{staticClass:"q-my-md"}):t._e(),s("div",{staticClass:"row justify-between items-center"},[s("div",{staticClass:"text-caption text-bold"},[t._v("Customer")]),t.customer?s("div",{staticClass:"text-bold"},[t._v(t._s(t.customer.name)+"     "),s("q-icon",{staticClass:"cursor-pointer",attrs:{name:"clear",size:"xs",color:"negative"},on:{click:function(e){return t.assignCustomer({id:null})}}})],1):s("OrderCustomer",{staticClass:"q-mt-sm",attrs:{get:"id"},model:{value:t.sCustomer,callback:function(e){t.sCustomer=e},expression:"sCustomer"}})],1),s("div",{staticClass:"row justify-between items-center"},[s("div",{staticClass:"text-caption text-bold"},[t._v("Tax")]),t.tax?s("div",{staticClass:"text-bold"},[t._v(t._s(t.tax)+"     "),s("q-icon",{staticClass:"cursor-pointer",attrs:{name:"clear",size:"xs",color:"negative"},on:{click:function(e){t.tax=""}}})],1):s("q-select",{staticClass:"q-mt-xs",staticStyle:{"min-width":"10rem"},attrs:{label:"Tax",dense:"",options:t.tax_natures,outlined:""},model:{value:t.tax,callback:function(e){t.tax=e},expression:"tax"}})],1)],1),s("q-list",{attrs:{bordered:"",separator:""}},[t._l(t.items_amount,(function(e){return s("q-item",{key:t.hKey(e)},[s("q-item-section",[s("q-item-label",[t._v(t._s(e.quantity)+" x "+t._s(t.itemName(e)))]),s("q-item-label",{attrs:{caption:""}},[t._v(t._s(e.quantity)+" x "+t._s(t.precision(e.price)))])],1),s("q-item-section",{staticClass:"text-black",attrs:{side:""}},[t._v("\n        "+t._s(t.precision(e.amount))+"\n      ")])],1)})),s("q-item",[s("q-item-section",[s("q-item-label",[t._v(" ")])],1),s("q-item-section",{staticClass:"text-black text-bold",staticStyle:{"font-size":"1.25rem"},attrs:{side:""}},[t._v(t._s(t.precision(t.total)))])],1),s("q-item",[s("q-item-section",[s("q-item-label",[t._v(" ")])],1),s("q-item-section",{staticClass:"text-black text-bold",staticStyle:{"font-size":"1.25rem"},attrs:{side:""}},[s("q-input",{attrs:{type:"number",dense:"",label:"Discount",outlined:""},model:{value:t.discount,callback:function(e){t.discount=t._n(e)},expression:"discount"}})],1)],1),s("q-item",{staticClass:"text-center bg-grey-2"},[s("q-item-section",[s("q-item-label",{staticClass:"text-weight-bolder",staticStyle:{"font-size":"1.5rem"}},[t._v(t._s(t.precision(t.total-t.discount)))]),s("q-item-label",{staticClass:"text-capitalize",attrs:{caption:""}},[t._v("Payable")])],1),s("q-item-section",{attrs:{side:""}},[s("q-btn",{attrs:{label:"Generate Bill",color:"light-blue",padding:"xs sm",dense:""},on:{click:t.generate}})],1)],1)],2),s("q-inner-loading",{attrs:{showing:t.loading}},[s("q-spinner-facebook",{attrs:{color:"primary",size:"2em"}})],1)],1)},r=[],o=(s("e6cf"),s("a79d"),s("ded3")),c=s.n(o),l=s("43fa"),d=s("b1c1"),u=s("2f62"),m=s("9708"),p={name:"TokenDetailCard",components:{OrderCustomer:m["a"],CardImageTitle:l["a"]},props:["id"],data(){return{loading:!1,src:"https://cdn.quasar.dev/img/parallax2.jpg",tax:null,discount:0}},computed:c()(c()({tid(){return _.toInteger(this.id)}},Object(u["d"])({token:function({tokens:{data:t}}){return t[this.tid]},seating:function({seating:{data:t}}){return t[this.token.seating]},customer:function({customers:{data:t}}){return t[this.token.customer]},items:function({tokens:{items:t}}){return _.filter(t[this.tid],(({progress:t})=>"Cancelled"!==t))},prices:function({prices:{data:t}}){return _(t).filter((({price_list:t,item:e})=>this.token.price_list===t&&this.items_id.includes(e))).mapKeys("item").mapValues((({price:t})=>_.toNumber(t))).value()},user:function({users:{data:t}}){return t[this.token.user]}})),{},{time(){return Object(d["p"])(this.token.date)},items_id(){return _.map(this.items,"item")},items_amount(){return _.map(this.items,(({item:t,quantity:e,id:s})=>_.zipObject(["id","item","price","quantity","amount"],[s,t,this.prices[t],e,this.prices[t]*e])))},total(){return _.sumBy(this.items_amount,"amount")},tax_natures(){return this.$store.getters["tax/natures"]},sCustomer:{get(){return _.get(this.customer,"id",null)},set(t){post("token","customer",{token:this.id,customer:t})}}}),methods:{precision(t){return Object(d["n"])(t)},hKey({id:t}){return Object(d["d"])("receptionist","token",this.id,"item",t)},itemName({item:t}){return _.get(this.$store.state.items.data,[_.toInteger(t),"name"])},assignCustomer({id:t}){post("token","customer",{token:this.id,customer:t})},generate(){if(this.loading=!0,!this.id||!this.customer)return this.loading=!1;let t={token:this.id,customer:this.customer.id,discount:this.discount,nature:this.tax};post("bill","create",t).then((()=>this.$store.dispatch("server/ping",null,{root:!0}))).catch().finally((()=>this.loading=!1))}}},b=p,x=s("2877"),v=s("f09f"),h=s("a370"),g=s("eb85"),C=s("0016"),f=s("ddd8"),q=s("1c1c"),k=s("66e5"),y=s("4074"),w=s("0170"),j=s("27f9"),Q=s("9c40"),S=s("74f7"),I=s("e669"),O=s("eebe"),z=s.n(O),T=Object(x["a"])(b,n,r,!1,null,null,null),$=T.exports;z()(T,"components",{QCard:v["a"],QCardSection:h["a"],QSeparator:g["a"],QIcon:C["a"],QSelect:f["a"],QList:q["a"],QItem:k["a"],QItemSection:y["a"],QItemLabel:w["a"],QInput:j["a"],QBtn:Q["a"],QInnerLoading:S["a"],QSpinnerFacebook:I["a"]});var D=s("c624"),K={name:"PageReceptionistTokens",components:{Masonry:D["a"],TokenDetailCard:$},computed:{tokens(){return _.filter(this.$store.state.tokens.data,["progress","Completed"])}},methods:{hKey({id:t}){return Object(d["d"])("receptionist","token","details",t)}}},B=K,L=s("9989"),N=Object(x["a"])(B,i,a,!1,null,null,null);e["default"]=N.exports;z()(N,"components",{QPage:L["a"]})}}]);