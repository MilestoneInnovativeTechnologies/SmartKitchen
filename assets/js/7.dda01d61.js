(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{2836:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{attrs:{padding:""}},t._l(t.my_kitchens,(function(e){return n("div",{key:t.hKey(e,"kitchen",e),staticClass:"row q-col-gutter-xs"},[n("div",{staticClass:"col-12 text-bold"},[t._v(t._s(t.kitchen_details[parseInt(e)].name))]),t._l(t.tokens,(function(i){return n("div",{key:t.hKey(e,"token",i),staticClass:"col-xs-6 col-sm-4 col-md-3 col-lg-2"},[n("TokenDetailCard",{attrs:{id:i,kitchen:e}})],1)}))],2)})),0)},s=[],a=(n("5db7"),n("73d9"),n("ded3")),r=n.n(a),c=n("2f62"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-card",[n("q-card-section",{staticClass:"bg-light-blue-3 q-pa-xs"}),n("q-card-actions",[n("div",{staticClass:"text-bold"},[t._v("ID: "+t._s(t.token.id))]),n("q-space"),n("q-badge",{attrs:{label:t.token.type}})],1),n("q-list",{attrs:{bordered:""}},t._l(t.items,(function(e){return n("TokenDetailCardItem",t._b({key:t.hKey(e),attrs:{token:t.token,user_kitchen:t.kitchen}},"TokenDetailCardItem",e,!1))})),1)],1)},l=[],m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-item",{attrs:{disable:!t.items.includes(parseInt(t.item))}},[n("q-item-section",[n("q-item-label",[t._v(t._s(t.quantity)+" x "+t._s(t.name))]),n("q-item-label",{staticClass:"text-primary",attrs:{caption:""}},[t._v(t._s(t.progress))]),t.kitchen&&t.kitchen!=t.user_kitchen?n("q-item-label",{staticClass:"text-secondary",attrs:{caption:""}},[t._v("Kitchen: "+t._s(t.kitchens[parseInt(t.kitchen)].name))]):t._e(),t.narration?n("q-item-label",{attrs:{caption:""}},[t._v(t._s(t.narration))]):t._e(),t.delay?n("q-item-label",{attrs:{caption:""}},[t._v(t._s(t.delay))]):t._e()],1),n("q-item-section",{staticClass:"text-center"},[n("q-item-label",{key:t.progresses,attrs:{caption:""}},[t._v(t._s(t.time)+" "+t._s(t.unit)+" ago")])],1),t.items.includes(parseInt(t.item))?n("q-item-section",{attrs:{side:""}},["New"===t.progress?n("q-btn",{attrs:{icon:"mark_chat_read",flat:"",color:"primary",padding:"0"},on:{click:t.accept}}):t._e(),"Accepted"===t.progress?n("q-btn",{attrs:{icon:"autorenew",flat:"",color:"primary",padding:"0"},on:{click:t.process}}):t._e(),"Processing"===t.progress?n("q-spinner-bars",{staticClass:"q-px-none",staticStyle:{cursor:"pointer"},attrs:{flat:"",color:"primary",size:"sm"},on:{click:t.complete}}):t._e()],1):t._e()],1)},d=[],u={name:"TokenDetailCardItem",props:["user_kitchen","id","item","progress","quantity","kitchen","narration","delay","progress_timing"],data(){return{since:0}},computed:{progresses(){if(this.progress_timing.length){let t=1e3*_.toSafeInteger(_.get(_.last(this.progress_timing),"time"));return this.since=_.toInteger(((new Date).getTime()-new Date(t).getTime())/1e3),setInterval((t=>t.since+=10),1e4,this),this.progress_timing.length}},name(){return _.get(this.$store.state.items.data,[_.toSafeInteger(this.item),"name"])},time(){let t=this.since,e=t<60?t:t<3600?_.toInteger(t/60):_.toInteger(t/3600);return _.toInteger(e)},unit(){let t=this.since;return t<60?"seconds":t<3600?"minutes":"hours"},items(){return this.$store.getters["kitchens/my_kitchen_items"](_.toInteger(this.user_kitchen))},kitchens(){return this.$store.state.kitchens.data}},methods:{accept(){post("token","accept",{id:this.id,kitchen:this.user_kitchen})},process(){post("token","process",{id:this.id})},complete(){post("token","complete",{id:this.id})}}},p=u,h=n("2877"),k=n("66e5"),g=n("4074"),b=n("58a8"),f=n("0170"),y=n("9c40"),q=n("a154"),I=n("eebe"),v=n.n(I),C=Object(h["a"])(p,m,d,!1,null,null,null),x=C.exports;v()(C,"components",{QItem:k["a"],QItemSection:g["a"],QBadge:b["a"],QItemLabel:f["a"],QBtn:y["a"],QSpinnerBars:q["a"]});var Q=n("b1c1"),j={name:"TokenDetailCard",components:{TokenDetailCardItem:x},props:["id","kitchen"],computed:r()(r()({},Object(c["c"])("tokens",{all:"data",token_items:"items"})),{},{token(){return _.get(this.all,_.toSafeInteger(this.id))},items(){return this.token_items[this.token.id]}}),methods:{hKey({token:t,item:e,id:n}){return Object(Q["a"])("token",t,"detail","item",e,"id",n)}}},w=j,S=n("f09f"),D=n("a370"),T=n("4b7e"),O=n("2c91"),K=n("1c1c"),$=Object(h["a"])(w,o,l,!1,null,null,null),A=$.exports;v()($,"components",{QCard:S["a"],QCardSection:D["a"],QCardActions:T["a"],QSpace:O["a"],QBadge:b["a"],QList:K["a"]});var B={name:"PageTokens",components:{TokenDetailCard:A},computed:r()(r()(r()(r()({},Object(c["c"])("tokens",{token_item:({items:t})=>_(t).flatMap().filter((({progress:t})=>["New","Accepted","Processing"].includes(t))).value()})),Object(c["b"])("kitchens",["kitchen_items","kitchen_item_stocks"])),Object(c["c"])("kitchens",{my_kitchens:"assign",kitchen_details:"data"})),{},{my_kitchen_token_items(){return _.filter(this.token_item,(({kitchen:t,item:e})=>_.includes(this.kitchen_items,_.toSafeInteger(e))&&(!t||_.includes(this.my_kitchens,_.toSafeInteger(t)))))},tokens(){return _.uniq(_.map(this.my_kitchen_token_items,(({token:t})=>_.toSafeInteger(t))))}}),methods:{hKey(t,e,n){return Object(Q["a"])("kitchen",t,e,"detail",n)}}},P=B,E=n("9989"),N=Object(h["a"])(P,i,s,!1,null,null,null);e["default"]=N.exports,v()(N,"components",{QPage:E["a"]})},b1c1:function(t,e,n){"use strict";function i(){return Array.from(arguments).join("-")}function s(t){return _.assign({},t,{label:[t.name,t.phone].join(", ")})}function a(t){return _(t).map(s).value()}function r(t,e){return _.toNumber(t).toFixed(e||2)}function c(t,e,n){let i=_.map(e,(e=>t[e])).join(n||",");return _.assign({},t,{label:i})}function o(t,e,n){return _.map(t,(t=>c(t,e,n||", ")))}n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return a})),n.d(e,"e",(function(){return r})),n.d(e,"d",(function(){return o}))}}]);