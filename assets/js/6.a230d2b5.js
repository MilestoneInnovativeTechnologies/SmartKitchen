(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"575d":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("q-layout",{attrs:{view:"hHh lpR fFf"}},[e("q-header",{staticClass:"bg-primary text-white",attrs:{elevated:"","height-hint":"98"}},[e("q-toolbar",[e("q-toolbar-title",[t._v("Order Online")]),e("ToolbarButton",{attrs:{icon:"grid_view"},nativeOn:{click:function(e){return t.view("grid")}}}),e("ToolbarButton",{attrs:{icon:"view_day"},nativeOn:{click:function(e){return t.view("list")}}}),e("q-btn",{directives:[{name:"show",rawName:"v-show",value:t.quantities,expression:"quantities"}],attrs:{flat:"",round:"",dense:"",icon:"shopping_basket"},on:{click:function(e){t.cart_show=!t.cart_show}}},[e("q-badge",{attrs:{color:"red",floating:"",label:t.quantities}})],1),e("div",{staticClass:"q-px-md"},[t._v("Â ")]),e("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"menu"},on:{click:function(e){t.drawer=!t.drawer}}},[t.order?e("q-badge",{staticClass:"q-pa-xs absolute-top-right",attrs:{rounded:"",color:"red",offset:[15,15]}}):t._e()],1)],1)],1),t.ready?e("q-page-container",[e("router-view")],1):e("q-page-container",[e("q-page",{attrs:{padding:""}},[e("div",{staticClass:"row q-col-gutter-sm"},t._l(12,(function(t){return e("div",{key:"om-s-"+t,staticClass:"col-xs-6 col-sm-4 col-md-3 col-lg-2 col-xl-1"},[e("OnlineMenuItemSkeleton")],1)})),0)])],1),e("q-drawer",{attrs:{side:"right",overlay:"",bordered:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[t.order?e("q-card",{staticClass:"q-ma-xs"},[e("q-card-section",{staticClass:"bg-teal text-white text-bold q-py-lg flex"},[e("div",[t._v("Order Details"),t.order.token?e("div",{staticClass:"text-caption text-bold text-italic"},[t._v("Token ID: "+t._s(t.order.token))]):t._e()]),e("q-space"),t.order.progress&&"Paid"!==t.order.progress?t._e():e("q-btn",{attrs:{flat:"",icon:"delete"},on:{click:function(e){return t.removeOrder(t.order)}}})],1),e("q-list",{attrs:{separator:""}},t._l(t.order.items,(function(a,r){return e("q-item",{key:"om-o-oi-i-"+a.item},[e("q-item-section",[e("q-item-label",{attrs:{caption:""}},[t._v("Rate: "+t._s(t.precision(a.rate)))]),e("q-item-label",{staticClass:"text-teal",staticStyle:{"font-size":"0.85rem"}},[e("span",{staticClass:"text-teal text-bold"},[t._v(t._s(a.quantity)+"x")]),t._v(" "+t._s(a.name))]),a.narration?e("q-item-label",{staticClass:"text-red text-italic",staticStyle:{"font-size":"0.75rem"},attrs:{caption:""}},[t._v(t._s(a.narration))]):t._e(),a.progress?e("q-item-label",{staticClass:"text-teal",staticStyle:{"font-size":"0.65rem"},attrs:{caption:""}},[t._v(t._s(a.progress))]):t._e()],1),e("q-item-section",{attrs:{side:""}},[e("q-item-label",{staticClass:"text-teal text-bold"},[t._v(t._s(t.precision(parseFloat(a.rate)*parseFloat(a.quantity))))])],1)],1)})),1),e("q-card-section",{staticClass:"q-pa-none text-white"},[e("q-list",[e("q-item",{staticClass:"bg-teal q-pa-none text-bold"},[e("q-item-section",{staticClass:"q-pa-md"},[e("q-input",{attrs:{value:t.order_status,label:"Status",readonly:"",dense:"",borderless:"","input-class":"text-white text-bold","label-color":"white"}}),e("q-linear-progress",{attrs:{indeterminate:"",color:"white"}})],1),e("q-item-section",{staticClass:"bg-teal-7 text-white",attrs:{side:""}},[e("q-item-label",{staticClass:"q-px-md",staticStyle:{"font-size":"1rem"}},[t._v(t._s(t.precision(t.order_total)))])],1)],1)],1)],1)],1):t._e(),e("q-list",{staticStyle:{"border-right":"none","border-left":"none"},attrs:{separator:"",bordered:""}},[e("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],class:0===t.group_selected?["bg-primary","text-white","q-py-md"]:["text-primary"],attrs:{clickable:""},on:{click:function(e){return t.select_group(0)}}},[e("q-item-section",{staticClass:"col-shrink",attrs:{avatar:""}},[e("q-icon",{attrs:{name:"reply"+(0===t.group_selected?"_all":"")}})],1),e("q-item-section",{staticClass:"text-bold"},[t._v("All")])],1),t._l(t.groups,(function(a){return e("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:"mlr-gl-g-"+a.id,class:t.group_selected===a.id?["bg-primary","text-white","q-py-md"]:["text-primary"],attrs:{clickable:""},on:{click:function(e){return t.select_group(a.id)}}},[e("q-item-section",{staticClass:"col-shrink",attrs:{avatar:""}},[e("q-icon",{attrs:{name:"reply"+(t.group_selected===a.id?"_all":"")}})],1),e("q-item-section",{staticClass:"text-bold"},[t._v(t._s(a.name))])],1)}))],2)],1),e("q-dialog",{attrs:{persistent:""},model:{value:t.cart_show,callback:function(e){t.cart_show=e},expression:"cart_show"}},[e("OnlineMenuCartDialogueCart",{style:t.popup,attrs:{items:t.cart},on:{order:t.add_order}})],1),e("q-dialog",{model:{value:t.confirm_delete,callback:function(e){t.confirm_delete=e},expression:"confirm_delete"}},[e("q-card",[e("q-card-section",{staticClass:"row items-center"},[e("q-avatar",{attrs:{icon:"delete",color:"red","text-color":"white"}}),e("span",{staticClass:"q-ml-sm"},[t._v("You are about to remove this order. Are you sure??")])],1),e("q-card-actions",{attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"info"}}),e("q-space"),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Yes, Remove Order",color:"red"},on:{click:function(e){return t.removeOrder(!0)}}})],1)],1)],1)],1)},s=[],i=(a("caad"),a("b7ef"),a("3c65"),function(){var t=this,e=t._self._c;return e("q-btn",t._b({attrs:{flat:"",round:"",dense:""}},"q-btn",t.$attrs,!1))}),o=[],n={name:"ToolbarButton"},l=n,c=a("2877"),d=a("9c40"),m=a("eebe"),p=a.n(m),u=Object(c["a"])(l,i,o,!1,null,null,null),b=u.exports;p()(u,"components",{QBtn:d["a"]});var h=a("bc3a"),q=a.n(h),g=function(){var t=this,e=t._self._c;return e("q-card",{attrs:{flat:""}},[e("q-card-section",{staticClass:"q-px-none q-pb-none"},[e("q-skeleton",{staticStyle:{height:"8rem"},attrs:{type:"rect"}})],1),e("q-card-section",{staticClass:"q-pa-none",attrs:{horizontal:""}},[e("q-card-section",{staticClass:"q-pa-none q-pt-xs col-8"},[e("q-skeleton",{staticStyle:{height:"2rem"},attrs:{type:"rect"}})],1),e("q-card-section",{staticClass:"q-pa-none q-pt-xs col-3 offset-1"},[e("q-skeleton",{staticStyle:{height:"2rem"},attrs:{type:"rect"}})],1)],1),e("q-card-actions",{staticClass:"q-px-none",attrs:{align:"right"}},[e("q-skeleton",{staticStyle:{width:"5rem",height:"2.5rem"},attrs:{type:"rect"}})],1)],1)},f=[],v={name:"OnlineMenuItemSkeleton"},y=v,x=a("f09f"),C=a("a370"),w=a("293e"),S=a("4b7e"),O=Object(c["a"])(y,g,f,!1,null,null,null),k=O.exports;p()(O,"components",{QCard:x["a"],QCardSection:C["a"],QSkeleton:w["a"],QCardActions:S["a"]});var Q=function(){var t=this,e=t._self._c;return e("q-card",{attrs:{square:""}},[e("q-bar",{staticClass:"bg-primary text-white q-py-lg"},[t._v("Cart Items "),e("q-space"),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-bold",attrs:{icon:"close",flat:"",dense:"",round:""}})],1),e("q-list",[e("transition-group",{attrs:{appear:"","enter-active-class":"animated zoomIn","leave-active-class":"animated zoomOut"}},t._l(t.items,(function(a,r){return e("q-item",{key:"om-ci-i-"+a.id,staticStyle:{"border-bottom":"1px solid #E5E5E5"}},[e("q-item-section",{staticClass:"col-shrink",attrs:{avatar:""}},[t._v(t._s(r+1))]),e("q-item-section",{staticClass:"col-shrink q-gutter-y-xs",attrs:{avatar:""}},[e("q-btn",{attrs:{icon:"add",dense:"",color:"primary",size:"xs"},on:{click:function(e){return t.increment(r)}}}),e("q-btn",{attrs:{icon:"remove",dense:"",color:"primary",size:"xs"},on:{click:function(e){return t.decrement(r)}}})],1),e("q-item-section",[e("q-item-label",{attrs:{caption:""}},[t._v("Rate: "+t._s(t.precision(a.rate)))]),e("q-item-label",{staticStyle:{"font-size":".85rem"}},[e("span",{staticClass:"text-bold text-primary",staticStyle:{"font-size":".95rem"}},[t._v(t._s(a.quantity)+"x")]),t._v(" "+t._s(a.name))])],1),e("q-item-section",{attrs:{side:""}},[e("q-item-label",{staticClass:"text-bold text-primary",staticStyle:{"font-size":".95rem"}},[t._v(t._s(t.precision(a.rate*a.quantity)))])],1)],1)})),1),e("q-item",{staticStyle:{"border-bottom":"1px solid #E5E5E5"}},[e("q-item-section",{staticClass:"text-center"},[e("q-item-label",{staticClass:"text-primary text-bold"},[t._v(t._s(t.items.length))]),e("q-item-label",{staticStyle:{"font-size":"0.60rem"},attrs:{caption:""}},[t._v("Total Items")])],1),e("q-item-section",{staticClass:"text-center"},[e("q-item-label",{staticClass:"text-primary text-bold"},[t._v(t._s(t.sumBy(t.items,"quantity")))]),e("q-item-label",{staticStyle:{"font-size":"0.60rem"},attrs:{caption:""}},[t._v("Total Quantity")])],1),e("q-item-section",{staticClass:"text-center"},[e("q-item-label",{staticClass:"text-primary text-bold",staticStyle:{"font-size":"1rem"}},[t._v(t._s(t.precision(t.sumBy(t.items,(({quantity:t,rate:e})=>t*e)))))]),e("q-item-label",{staticStyle:{"font-size":"0.60rem"},attrs:{caption:""}},[t._v("Total Amount")])],1)],1)],1),e("q-card-actions",{attrs:{align:"right"}},[e("q-btn",{attrs:{label:"Place Order",color:"primary",padding:"xs md",glossy:""},on:{click:function(e){return t.$emit("order")}}})],1)],1)},I=[],z=a("b1c1"),N={name:"OnlineMenuCartDialogueCart",props:["items"],methods:{precision:z["z"],sumBy:_.sumBy,increment(t){this.$store.commit("update",{path:["cart",t,"quantity"],value:this.items[t].quantity+1})},decrement(t){let e=this.items[t].quantity-1;this.$store.commit("update",{path:["cart",t,"quantity"],value:e}),e<1&&setTimeout(((t,e)=>t.$store.commit("splice",{path:["cart"],start:e,length:1})),1500,this,t)}}},j=N,B=a("d847"),$=a("2c91"),P=a("1c1c"),T=a("66e5"),J=a("4074"),A=a("0170"),M=a("7f67"),D=Object(c["a"])(j,Q,I,!1,null,null,null),E=D.exports;p()(D,"components",{QCard:x["a"],QBar:B["a"],QSpace:$["a"],QBtn:d["a"],QList:P["a"],QItem:T["a"],QItemSection:J["a"],QItemLabel:A["a"],QCardActions:S["a"]}),p()(D,"directives",{ClosePopup:M["a"]});var L=a("3e26"),R={name:"MenuLayout",components:{OnlineMenuCartDialogueCart:E,OnlineMenuItemSkeleton:k,ToolbarButton:b},props:["reference","code"],data(){return{ready:!1,drawer:!1,cart_show:!1,confirm_delete:!1}},computed:{menu(){return this.ready?_.toInteger(this.$store.state.public.params.menu):0},groups(){return this.ready?_.filter(this.$store.state.public.Groups,(({menus:t})=>t.includes(this.menu))):[]},branch(){return this.$store.state.public.branch},group_selected(){return _.get(this.$store.state.public,"group_selected",0)},cart(){return this.$store.state.public.cart},quantities(){return _.sumBy(this.cart,"quantity")},order(){return this.$store.state.public.order},order_total(){return this.order?_.sumBy(this.order.items,(({rate:t,quantity:e})=>_.toNumber(t)*_.toNumber(e))):0},items_completed(){let t=_.get(this.order,"items",[]);return _.every(t,(({progress:t})=>_.includes(["Completed","Served","Cancelled"],t)))},order_status(){let{status:t,progress:e}=this.order;return e?"New"===e?"Order Confirmed":"Processing"===e?this.items_completed?"All Items Prepared":"Confirmed - Preparing":"Completed"===e?"Items Served":"Billed"===e?"Served - Bill Generated":"Partial"===e?"Paid Partially":e:t},popup(){return Object(z["y"])()}},methods:{precision:z["z"],public(t){this.$store.commit("public",t)},select_group(t){this.$store.commit("update",{path:["group_selected"],value:t}),this.drawer=!1},view(t){this.$store.commit("update",{path:["view"],value:t})},load_assets(){const t=this;return new Promise((async function(e){localStorage.setItem(t.reference,"local"===t.reference?JSON.stringify(_.get(await q.a.get(location.origin+"/assets/online/menu.js?_="+Math.random()),"data")):JSON.stringify(_.get(await q.a.get(await Object(L["b"])(t.reference)),"data"))),t.public(JSON.parse(localStorage.getItem(t.reference))),e(t)}))},clear_cart(){this.$store.commit("splice",{path:"cart",start:0,length:this.cart.length}),this.cart_show=!1},add_order(){let t=_.pick(this.$store.state.public.params,["type","seating","price_list","customer"]);t.items=_.map(this.cart,(({id:t,quantity:e,rate:a,name:r})=>_.zipObject(["item","quantity","rate","name","progress"],[t,e,a,r,null]))),t=_.assign({},t,{status:"Waiting for Approval",token:null,active:!0,time:Object(z["t"])(),progress:null}),"local"===this.reference||F(this.reference,this.branch,t,this.clear_cart,this.orderUpdate)},orderUpdate({id:t,data:e}){if(!e.active||"Paid"===e.progress&&Object(z["t"])()-e.time>1800||"Cancelled"===e.progress)return G(t);_.has(e,"id")||(e.id=t),this.public({order:e})},removeOrder(t){!0===t?(this.order.token?G(this.order.id):G(this.order.id,this.reference,this.branch),location.reload()):this.confirm_delete=!0}},created(){const t=function(t){const e=JSON.parse(atob(t.code)),a=0;e["price_list"]=e.price_list||_.get(t.$store.state.public,["Seats",e.seating,"price_list"]),t.public({params:e,group_selected:a,cart:[],view:"grid",branch:e.branch}),t.ready=!0};if(localStorage.getItem(this.reference)?(setTimeout(this.load_assets,9e4),this.public(JSON.parse(localStorage.getItem(this.reference))),t(this)):this.load_assets().then(t),"local"===this.reference?this.public({images:null}):Object(L["a"])(this.reference).then((t=>this.public({images:t}))),"local"===this.reference);else{const t=JSON.parse(localStorage.getItem("online_orders")||"[]");_.isEmpty(t)||Object(L["d"])(Object(L["f"])(this.reference,this.branch,t[0]),(t=>this.orderUpdate({id:t.id,data:t.data()})))}}};function F(t,e,a,r,s){Object(L["e"])(t,e,a).then((t=>{U(t.id),r(),Object(L["d"])(t,(t=>s({id:t.id,data:t.data()})))}))}function U(t){const e=JSON.parse(localStorage.getItem("online_orders")||"[]");return e.includes(t)||(e.unshift(t),localStorage.setItem("online_orders",JSON.stringify(e))),t}function G(t,e,a){let r=JSON.parse(localStorage.getItem("online_orders")||"[]");return r.includes(t)&&(r=_.difference(r,[t]),localStorage.setItem("online_orders",JSON.stringify(r))),e&&a&&Object(L["h"])(Object(L["f"])(e,a,t),{active:!1}),t}var H=R,Y=a("4d5a"),W=a("e359"),K=a("65c6"),V=a("6ac5"),X=a("58a8"),Z=a("09e3"),tt=a("9989"),et=a("9404"),at=a("27f9"),rt=a("6b1d"),st=a("0016"),it=a("24e8"),ot=a("cb32"),nt=a("714f"),lt=Object(c["a"])(H,r,s,!1,null,null,null);e["default"]=lt.exports;p()(lt,"components",{QLayout:Y["a"],QHeader:W["a"],QToolbar:K["a"],QToolbarTitle:V["a"],QBtn:d["a"],QBadge:X["a"],QPageContainer:Z["a"],QPage:tt["a"],QDrawer:et["a"],QCard:x["a"],QCardSection:C["a"],QSpace:$["a"],QList:P["a"],QItem:T["a"],QItemSection:J["a"],QItemLabel:A["a"],QInput:at["a"],QLinearProgress:rt["a"],QIcon:st["a"],QDialog:it["a"],QAvatar:ot["a"],QCardActions:S["a"]}),p()(lt,"directives",{Ripple:nt["a"],ClosePopup:M["a"]})}}]);