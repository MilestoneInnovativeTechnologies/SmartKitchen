(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[28],{"23ad":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",[a("FilterInputText",{staticClass:"q-ma-md",on:{text:function(e){t.filter=e}}}),a("q-list",{attrs:{separator:""}},t._l(t.showing,(function(e,s){return a("BillListItem",{key:t.hKey(e,s,"a-b-b"),class:{"bg-grey-1":s%2},attrs:{bill:e,clickable:""},nativeOn:{click:function(e){t.show=(t.selected=s,!0)}}})})),1),a("q-dialog",{attrs:{persistent:"","transition-show":"flip-down","transition-hide":"flip-up"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[t.bill?a("BillDetail",{staticStyle:{"min-width":"80vw"},attrs:{bill:t.bill},on:{print:function(e){return t.print(t.bill)},done:function(e){t.show=!1}}}):t._e()],1),a("Pagination",{attrs:{records:t.Bills,color:"teal"},model:{value:t.showing,callback:function(e){t.showing=e},expression:"showing"}})],1)},i=[],l=(a("26e9"),a("58d1")),n=a("b1c1"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-item",t._b({},"q-item",t.$attrs,!1),[a("q-item-section",{attrs:{avatar:""}},[a("q-badge",{staticClass:"q-pa-sm",staticStyle:{"font-size":"0.65rem"},attrs:{color:"teal",label:t.bill.id}})],1),a("q-item-section",[a("q-item-label",{staticClass:"text-teal"},[t._v(t._s(t.bill.customer?t.bill.customer.name:""))]),a("q-item-label",{attrs:{caption:""}},[t._v(t._s(t.items()))]),a("q-item-label",{attrs:{caption:""}},[t._v("Token: "+t._s(t.bill.token?t.bill.token.id:"")+", Type: "+t._s(t.bill.token?t.bill.token.type:"")+", "+t._s(t.human_date(t.bill.date,!0)))])],1),a("q-item-section",{attrs:{side:""}},[a("div",{staticClass:"text-teal text-bold",staticStyle:{"font-size":"1.1rem"}},[a("span",{directives:[{name:"show",rawName:"v-show",value:"Paid"!==t.bill.progress,expression:"bill.progress !== 'Paid'"}],staticClass:"text-caption"},[t._v(t._s(t.bill.paid)+"/")]),t._v(t._s(parseFloat(t.bill.payable).toFixed(2)))])])],1)},r=[],c={name:"BillListItem",props:["bill"],methods:{human_date:n["f"],items(){return _.map(_.get(this.bill,["token","items"]),(t=>_.get(t,["item","name"]))).join(", ")}}},d=c,m=a("2877"),p=a("66e5"),b=a("4074"),u=a("58a8"),h=a("0170"),x=a("eebe"),v=a.n(x),y=Object(m["a"])(d,o,r,!1,null,null,null),q=y.exports;v()(y,"components",{QItem:p["a"],QItemSection:b["a"],QBadge:u["a"],QItemLabel:h["a"]});var g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card",[a("q-card-section",{staticClass:"bg-teal-7 text-white",attrs:{horizontal:""}},[a("q-card-section",{staticClass:"bg-teal"},[a("div",{staticClass:"text-caption"},[t._v(t._s(t.human_date2(t.bill.date,!0)))]),a("div",{staticClass:"text-h5 text-bold"},[t._v(t._s(parseFloat(t.bill.payable).toFixed(2)))]),a("div",{staticClass:"text-caption"},[t._v("Bill ID: "+t._s(t.bill.id))]),a("div",{staticClass:"text-caption",staticStyle:{"line-height":"0.45rem"}},[t._v("Token ID: "+t._s(t.bill.token.id))])]),a("q-card-section",[a("q-badge",{staticClass:"q-mt-md q-px-lg q-py-sm",attrs:{color:"grey-1","text-color":"teal",label:t.bill.token.type}})],1),a("q-card-section",{staticClass:"col-grow text-right"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"absolute-top-right q-mr-xs q-mt-xs",attrs:{icon:"close","text-color":"teal-1",dense:"",rounded:"",flat:""}}),a("div",{staticClass:"q-mt-xl"}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.bill.nature,expression:"bill.nature"}],staticClass:"text-caption text-italic",staticStyle:{"font-size":"0.70rem","line-height":"0.70rem"}},[t._v(t._s(t.bill.nature))]),a("div",{staticClass:"text-subtitle1",staticStyle:{"line-height":"1.1rem"}},[t._v(t._s(t.bill.customer?t.bill.customer.name:""))]),a("div",{staticClass:"text-subtitle2",staticStyle:{"font-size":"0.8rem","line-height":"1.1rem"}},[t._v(t._s(t.bill.customer?t.bill.customer.phone:""))])],1)],1),a("q-card-section",{staticClass:"row items-center justify-between q-pb-sm"},[a("div",{staticClass:"text-center text-teal text-bold",staticStyle:{"line-height":"1"}},[t._v(t._s(parseFloat(t.bill.amount).toFixed(2))),a("br"),a("span",{staticClass:"text-caption text-uppercase",staticStyle:{"font-size":"0.60rem"}},[t._v("Amount")])]),a("div",{staticClass:"text-center text-teal text-bold",staticStyle:{"line-height":"1"}},[t._v(t._s(parseFloat(t.bill.discount).toFixed(2))),a("br"),a("span",{staticClass:"text-caption text-uppercase",staticStyle:{"font-size":"0.60rem"}},[t._v("Discount")])]),a("div",{staticClass:"text-center text-teal text-bold",staticStyle:{"line-height":"1"}},[t._v(t._s(parseFloat(t.bill.payable).toFixed(2))),a("br"),a("span",{staticClass:"text-caption text-uppercase",staticStyle:{"font-size":"0.60rem"}},[t._v("Payable")])])]),a("q-list",{staticClass:"bg-grey-2",attrs:{bordered:""}},[t._l(t.bill.contents,(function(e,s){return[a("q-item",{key:"ab-dv-bc-"+s},[a("q-item-section",[a("q-item-label",{staticClass:"text-teal",staticStyle:{"font-size":"0.65rem"},attrs:{caption:""}},[t._v(t._s(parseFloat(e.price).toFixed(2)))]),a("q-item-label",[a("span",{staticClass:"text-teal text-bold"},[t._v(t._s(e.quantity)+" x ")]),t._v(t._s(e.name))])],1),a("q-item-section",[a("q-item-label",{staticStyle:{"font-size":"0.55rem"},attrs:{caption:""}},[t._v("DISCOUNT")]),a("q-item-label",[a("span",{staticClass:"text-teal text-bold"},[t._v(t._s(Math.round(parseFloat(e.discount)).toFixed(2)))])])],1),a("q-item-section",{staticClass:"text-teal text-bold text-subtitle2",attrs:{side:""}},[t._v(t._s(Math.round(parseFloat(e.quantity)*parseFloat(e.price)-parseFloat(e.discount)).toFixed(2)))])],1),e.tax&&parseFloat(e.tax.amount)>0?a("div",{staticStyle:{transform:"translateY(-0.4rem)"}},[a("div",{staticClass:"q-px-md text-grey",staticStyle:{"font-size":"0.65rem"}},[t._v("Included Tax Details"),a("br"),t._v(t._s(e.tax.name)+" - "+t._s(Math.round(parseFloat(e.tax.amount)).toFixed(2)))]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.tax.contents&&e.tax.contents.length>1,expression:"content.tax.contents && content.tax.contents.length > 1"}]},t._l(e.tax.contents,(function(e,i){return a("div",{key:"abd-i-"+s+"-tc-"+i,staticClass:"q-px-xl",staticStyle:{"font-size":"0.65rem"}},[a("q-icon",{attrs:{name:"subdirectory_arrow_right"}}),t._v(" "+t._s(e.name)+" - "+t._s(Math.round(e.amount).toFixed(2)))],1)})),0)]):t._e(),a("q-separator",{staticClass:"q-mt-xs"})]}))],2),t.payments.length>0?a("q-list",{attrs:{separator:""}},[a("q-item-label",{attrs:{header:""}},[t._v("Payments")]),t._l(t.payments,(function(e,s){return a("q-item",{key:"ab-dv-b-"+t.bill.id+"-ps-"+s,staticClass:"bg-grey-2"},[a("q-item-section",{attrs:{avatar:""}},[a("q-item-label",{attrs:{caption:""}},[t._v(t._s(e.type))])],1),a("q-item-section",[a("q-item-label",{staticClass:"text-body2 text-caption"},[t._v(t._s(t.human_date2(e.date)))]),e.detail?a("q-item-label",{staticStyle:{"font-size":"0.65rem"},attrs:{caption:""}},[t._v(t._s(e.detail))]):t._e()],1),a("q-item-section",{staticClass:"text-teal text-bold text-subtitle2",attrs:{side:""}},[t._v(t._s(parseFloat(e.amount).toFixed(2)))]),a("q-item-section",{attrs:{side:""}},[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"close",color:"red",size:"xs"},on:{click:function(a){return t.payment_cancel(e)}}})],1)],1)})),a("q-item",[a("q-item-section",{attrs:{avatar:""}},[a("q-item-label",{attrs:{caption:""}},[t._v("Â ")])],1),a("q-item-section",[a("q-item-label",{staticClass:"text-body2 text-bold text-teal"},[t._v("Total Paid")])],1),a("q-item-section",{staticClass:"text-teal text-bold text-subtitle2",attrs:{side:""}},[t._v(t._s(parseFloat(t.bill.paid).toFixed(2)))]),a("q-item-section",{attrs:{side:""}},[a("q-icon",{attrs:{name:"close",color:"white",size:"xs"}})],1)],1)],2):t._e(),a("q-separator"),a("q-card-actions",{directives:[{name:"show",rawName:"v-show",value:"Cancelled"!==t.bill.progress,expression:"bill.progress !== 'Cancelled'"}],staticClass:"bg-grey-3"},[a("q-btn",{attrs:{type:"a",size:"sm",dense:"",flat:"","text-color":"red",label:"Cancel Bill"},on:{click:t.bill_cancel}}),a("q-space"),a("q-btn",{directives:[{name:"show",rawName:"v-show",value:t.bill.payable>t.bill.paid,expression:"bill.payable > bill.paid"}],attrs:{dense:"",color:"cyan",size:"sm",label:"Add Payment"},on:{click:function(e){t.add_payment=!0}}}),a("q-btn",{attrs:{dense:"",color:"teal",size:"sm",label:"Print"},on:{click:function(e){return t.$emit("print")}}})],1),a("q-dialog",{attrs:{persistent:"","transition-show":"zoom-in","transition-hide":"zoom-out"},model:{value:t.add_payment,callback:function(e){t.add_payment=e},expression:"add_payment"}},[a("BillPaymentAdd",{staticStyle:{"min-width":"60vw"},attrs:{bill:t.bill},on:{added:function(e){t.add_payment=!1}}})],1)],1)},f=[],C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card",[a("q-card-section",{staticClass:"row items-center q-pa-sm bg-grey-4"},[a("q-icon",{staticClass:"q-mr-sm",attrs:{name:"account_balance"}}),a("span",[t._v("Add New Payment")]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",size:"sm",flat:"",round:"",dense:""}})],1),a("q-card-section",{staticClass:"q-gutter-y-xs"},[a("DateTime",{attrs:{dense:"",outlined:""},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}}),a("q-select",{attrs:{dense:"",outlined:"",options:t.PaymentsTypes,label:"Payment Type"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}}),a("q-input",{attrs:{dense:"",outlined:"",type:"number",label:"Amount"},model:{value:t.amount,callback:function(e){t.amount=t._n(e)},expression:"amount"}}),a("q-input",{staticStyle:{height:"5rem"},attrs:{dense:"",outlined:"",type:"textarea",label:"Details"},model:{value:t.detail,callback:function(e){t.detail=e},expression:"detail"}})],1),a("q-card-actions",{staticClass:"bg-grey-3",attrs:{align:"right"}},[a("q-btn",{attrs:{loading:t.loading,label:"Save",color:"primary",size:"sm"},on:{click:t.save}})],1)],1)},w=[],S=a("232e"),k=a("5dee"),F={name:"BillPaymentAdd",components:{DateTime:k["a"]},props:["bill"],data(){return{loading:!1,PaymentsTypes:S["PaymentsTypes"],date:"",amount:0,type:S["PaymentsTypes"][0],detail:""}},created(){this.amount=_.toNumber(this.bill.payable)-_.toNumber(this.bill.paid),this.date=Object(n["E"])("YYYY-MM-DD HH:mm:ss",new Date)},methods:{save(){this.loading=!0,post("payment","create",{bill:this.bill.id,date:this.date,amount:this.amount,type:this.type,detail:this.detail}).then(this.saved)},saved(){this.$emit("added"),this.loading=!1}}},Q=F,z=a("f09f"),B=a("a370"),P=a("0016"),I=a("2c91"),D=a("9c40"),T=a("ddd8"),A=a("27f9"),N=a("4b7e"),j=a("7f67"),$=Object(m["a"])(Q,C,w,!1,null,null,null),O=$.exports;v()($,"components",{QCard:z["a"],QCardSection:B["a"],QIcon:P["a"],QSpace:I["a"],QBtn:D["a"],QSelect:T["a"],QInput:A["a"],QCardActions:N["a"]}),v()($,"directives",{ClosePopup:j["a"]});var L={name:"BillDetail",components:{BillPaymentAdd:O},props:["bill"],data(){return{add_payment:!1}},computed:{payments(){return this.bill&&this.bill.payments.length?_.filter(this.bill.payments,["status","Active"]):[]}},methods:{human_date2:n["g"],payment_cancel({id:t}){this.$store.dispatch("payments/cancel",t,{root:!0}).then((()=>this.$emit("done")))},bill_cancel(){this.$store.dispatch("bills/cancel",this.bill,{root:!0}).then((()=>this.$emit("done")))}}},M=L,E=a("1c1c"),Y=a("eb85"),H=a("24e8"),J=Object(m["a"])(M,g,f,!1,null,null,null),K=J.exports;v()(J,"components",{QCard:z["a"],QCardSection:B["a"],QBadge:u["a"],QBtn:D["a"],QList:E["a"],QItem:p["a"],QItemSection:b["a"],QItemLabel:h["a"],QIcon:P["a"],QSeparator:Y["a"],QCardActions:N["a"],QSpace:I["a"],QDialog:H["a"]}),v()(J,"directives",{ClosePopup:j["a"]});var U=a("5ab9"),G=a("1799"),R={name:"PageArchiveBills",components:{Pagination:G["a"],FilterInputText:U["a"],BillDetail:K,BillListItem:q},mixins:[l["a"]],data(){return{selected:null,show:!1,filter:"",showing:null}},computed:{AllBills(){return _(this.bills).filter((({progress:t})=>"Cancelled"!==t)).map((t=>Object.assign({},t,{slug:V(t)}))).sortBy((({date:t})=>Object(n["d"])(t).getTime())).reverse().value()},Bills(){return this.filter?_.filter(this.AllBills,(({slug:t})=>_.includes(t,this.filter.toLowerCase()))):this.AllBills},bill(){return null===this.selected?null:this.showing[this.selected]}},methods:{hKey(t,e,a){return Object(n["e"])(a,e,t.id)},print({id:t}){post("bill","print",{id:t})}}};function V({id:t,customer:e,amount:a,token:s}){return[_.get(s,"id"),t,_.get(e,"name"),_.toNumber(a),s.type].join(" ").toLowerCase()}var W=R,X=a("9989"),Z=Object(m["a"])(W,s,i,!1,null,null,null);e["default"]=Z.exports;v()(Z,"components",{QPage:X["a"],QList:E["a"],QDialog:H["a"]})}}]);