(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[113],{c2e6:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e._self._c;return t("q-page",{directives:[{name:"scroll",rawName:"v-scroll",value:e.scrolled,expression:"scrolled"}],staticClass:"q-gutter-y-sm",attrs:{padding:""}},[t("OrderWaiterSummary",{staticClass:"q-mt-md"}),t("OrderWaiterServable",{staticClass:"q-mt-md"}),t("OnlineOrdersPendingList",{attrs:{color:"indigo",title:"Pending Online Orders"}}),t("OrderOngoingTables",{staticClass:"q-mt-md"}),t("transition",{attrs:{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[t("q-page-sticky",{directives:[{name:"show",rawName:"v-show",value:e.fab,expression:"fab"}],attrs:{position:"bottom-right",offset:e.offset}},[t("q-fab",{directives:[{name:"touch-pan",rawName:"v-touch-pan.prevent.mouse",value:e.move,expression:"move",modifiers:{prevent:!0,mouse:!0}}],attrs:{icon:"add",color:"primary",glossy:"",to:{name:"order_new",params:{type:"Dining",seat:!0,user:e.$route.meta.me.id}}}})],1)],1)],1)},a=[],i=(s("9861"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"row q-col-gutter-xs"},e._l(e.d_status,(function(s,r){return t("div",{key:"order-waiter-summary-status-"+s,staticClass:"col-xs-6 col-sm-3"},[t("DigitMetric",{attrs:{value:e.orderOfStatus(s),title:s,bg:e.prop[r][0],text:"white",icon:e.prop[r][1]}})],1)})),0)}),n=[],o=s("84ba"),l={name:"OrderWaiterSummary",components:{DigitMetric:o["a"]},data(){return{d_status:["New","Processing","Completed","Billed"],prop:[["cyan","note_add"],["orange","published_with_changes"],["green","done"],["blue","done_outline"]]}},computed:{myID(){return _.get(this.$route,["meta","me","id"])},orders(){return _.filter(this.$store.getters["tokens/today"],["user",this.myID])},total(){return _.size(this.orders)}},methods:{orderOfStatus(e){return _.sumBy(_.values(this.orders),(({progress:t})=>_.toSafeInteger(e===t)))}}},c=l,d=s("2877"),m=Object(d["a"])(c,i,n,!1,null,null,null),u=m.exports,g=(s("caad"),function(){var e=this,t=e._self._c;return t("q-card",[t("q-card-section",{staticClass:"row justify-between text-bold bg-green text-white"},[t("div",[e._v("Order Items to Serve")]),e.servable.length>0?t("div",[e._v(e._s(e.servable.length))]):e._e()]),e.servable.length?t("q-list",{attrs:{separator:"",bordered:""}},e._l(e.servable,(function(s){return t("q-item",{key:"order-waiter-servable-item-"+s.id},[t("q-item-section",[t("q-item-label",[e._v(e._s(s.quantity)+" X "+e._s(e.itemName(s.item)))]),t("q-item-label",{attrs:{caption:""}},[e._v("Kitchen: "+e._s(e.kitchenName(s.kitchen)))]),t("q-item-label",{attrs:{caption:""}},[e._v("Seating: "+e._s(e.SeatingName(s.token)))])],1),t("q-item-section",{attrs:{side:""}},[t("q-item-label",{attrs:{caption:""}},[e._v(e._s(e.itemTiming(s.progress_timing))+" ago")])],1),t("q-item-section",{attrs:{side:""}},[t("q-btn",{attrs:{icon:"how_to_reg",color:"positive",round:"",dense:""},on:{click:function(t){return e.served(s)}}})],1),e.serving.includes(s.id)?t("q-inner-loading",{attrs:{showing:!0}},[t("q-spinner-facebook",{attrs:{color:"primary",size:"2em"}})],1):e._e()],1)})),1):t("q-card-section",{staticClass:"text-center"},[e._v("NO ITEMS RIGHT NOW..")])],1)}),p=[],h=(s("14d9"),s("b1c1")),b={name:"OrderWaiterServable",data(){return{d_status:["New","Processing","Completed","Billed","Cancelled"],serving:[]}},computed:{orders(){return _(this.$store.state.tokens.data).filter({type:"Dining",progress:"Processing"}).mapKeys((({id:e})=>parseInt(e))).value()},items(){return _.flatMap(_.pick(this.$store.state.tokens.items,_.keys(this.orders)))},servable(){return _.filter(this.items,["progress","Completed"])}},methods:{itemName(e){return _.get(this.$store.state.items.data,[e,"name"])},kitchenName(e){return _.get(this.$store.state.kitchens.data,[e,"name"])},SeatingName(e){return _.get(this.$store.state.seating.data,[_.get(this.orders,[e,"seating"]),"name"])},since(e){let t=_.get(_.last(e),"time"),s=_.toInteger((new Date).getTime()/1e3);return s-t},itemTiming(e){let t=this.since(e);return t<60?t+" seconds":t<3600?_.toInteger(t/60)+" minutes":_.toInteger(t/3600)+" hours"},served({id:e}){this.serving.push(e),post("token","served",{id:e}).then((()=>this.serving=_.difference(this.serving,[e])))}},watch:{servable(e,t){(!t||e.length>t.length)&&Object(h["b"])()}}},v=b,f=s("f09f"),q=s("a370"),C=s("1c1c"),k=s("66e5"),y=s("4074"),O=s("0170"),w=s("9c40"),x=s("74f7"),S=s("e669"),I=s("eebe"),Q=s.n(I),P=Object(d["a"])(v,g,p,!1,null,null,null),N=P.exports;Q()(P,"components",{QCard:f["a"],QCardSection:q["a"],QList:C["a"],QItem:k["a"],QItemSection:y["a"],QItemLabel:O["a"],QBtn:w["a"],QInnerLoading:x["a"],QSpinnerFacebook:S["a"]});var T=function(){var e=this,t=e._self._c;return e.tokens.length?t("div",[t("div",{staticClass:"text-h6 q-mb-sm q-ml-sm"},[e._v("Ongoing Seating")]),t("Masonry",{attrs:{items:e.tokens,width:"300"},scopedSlots:e._u([{key:"item",fn:function(s){return[t("div",{staticClass:"col-xs-6 col-sm-4 col-md-3 col-lg-2 col-xl-1"},[t("q-card",{class:"bg-"+e.cColor[s.progress]},[t("q-card-section",{staticClass:"q-py-xs",class:"bg-"+e.cColor[s.progress]}),t("q-img",{attrs:{basic:"",src:e.media(s.seating.image)}},[t("div",{staticClass:"absolute-bottom text-subtitle2 text-center"},[t("div",{staticClass:"text-h6"},[e._v(e._s(s.seating.name))]),s.customer?t("div",{staticClass:"text-subtitle2"},[e._v(e._s(s.customer.name))]):e._e(),t("div",[t(e.spinners[s.progress],{tag:"component",attrs:{color:e.bColor[s.progress],size:"sm"}}),t("q-badge",{staticClass:"q-ml-xs q-py-xs",attrs:{color:e.bColor[s.progress],label:s.progress}}),t("q-badge",{staticClass:"q-ml-xs q-py-xs",attrs:{color:e.bColor[s.progress],label:s.id}})],1)])]),s.items.length?t("q-list",{attrs:{bordered:"",separator:""}},e._l(s.items,(function(r,a){return t("q-item",{key:e.hKey(s.id,a,r.id)},[t("q-item-section",[t("q-item-label",{staticClass:"text-bold"},[e._v(e._s(r.quantity)+" X "+e._s(r.name))]),r.kitchen?t("q-item-label",{attrs:{caption:""}},[t("q-icon",{attrs:{size:"xs",name:"outdoor_grill"}}),e._v(" "+e._s(r.kitchen.name))],1):e._e(),r.narration?t("q-item-label",{staticClass:"text-italic",attrs:{caption:""}},[e._v(e._s(r.narration))]):e._e()],1),t("q-item-section",{attrs:{side:""}},[t("q-badge",{staticClass:"q-py-xs",attrs:{color:"blue",label:r.progress}})],1)],1)})),1):e._e(),t("BrowserPrintCardActions",{attrs:{token:s}})],1)],1)]}}],null,!1,36518108)})],1):e._e()},j=[],$=s("2f62"),D=s("232e"),B=s("43fa"),L=s("c624"),W=s("36d9"),M={name:"OrderOngoingTables",components:{BrowserPrintCardActions:W["a"],Masonry:L["a"],CardImageTitle:B["a"]},data(){return{cColor:{New:"red-2",Processing:"purple-2",Completed:"green-2"},bColor:D["TokenProgressColor"],spinners:{New:"q-spinner-ball",Processing:"q-spinner-rings",Completed:null}}},computed:{fProgress(){return _.keys(this.cColor)},me(){return _.get(this.$route,["meta","me","id"])},receptionists(){return _(this.$store.state.users.data).filter(["role","Receptionist"]).map((e=>_.toSafeInteger(e.id))).value()},allowable_users(){return _.concat(null,this.me,this.receptionists)},...Object($["d"])({items({items:{data:e}}){return _(e).mapValues("name").value()},kitchens({kitchens:{data:e}}){return e},tokens({tokens:{data:e,items:t},seating:s,customers:r}){return _(e).filter((({progress:e,type:t,user:s})=>this.fProgress.includes(e)&&"Dining"===t&&_.includes(this.allowable_users,s))).map((e=>Object.assign({},e,{items:this.iNameAttach(t[e.id])},{seating:_.get(s,["data",e.seating],{})},{customer:_.get(r,["data",e.customer])}))).value()}})},methods:{iNameAttach(e){return _(e).map((e=>Object.assign({},e,{name:_.get(this.items,[e.item]),kitchen:_.get(this.kitchens,[e.kitchen],null)}))).value()},hKey(e,t,s){return Object(h["e"])("order","ongoing","tables","order",e,"item","index",t,"item",s)},media(e){return e?Object(h["i"])(e):void 0}}},z=M,A=s("068f"),K=s("58a8"),R=s("0016"),F=s("a403"),J=s("792f"),X=Object(d["a"])(z,T,j,!1,null,null,null),E=X.exports;Q()(X,"components",{QCard:f["a"],QCardSection:q["a"],QImg:A["a"],QBadge:K["a"],QList:C["a"],QItem:k["a"],QItemSection:y["a"],QItemLabel:O["a"],QIcon:R["a"],QSpinnerBall:F["a"],QSpinnerRings:J["a"]});var G=s("1c16"),H=s("79d0"),U={name:"PageWaiterIndex",components:{OnlineOrdersPendingList:H["a"],OrderOngoingTables:E,DigitMetric:o["a"],OrderWaiterServable:N,OrderWaiterSummary:u},data(){return{token:new URLSearchParams(document.location.search.substring(1)).get("token"),fab:!0,offset:[24,24]}},methods:{scrolled:Object(G["a"])((function(){this.fab=!1}),500,!0),move(e){this.offset=[this.offset[0]-e.delta.x,this.offset[1]-e.delta.y]}},watch:{fab(e){e||(clearTimeout(this.timeout),this.timeout=setTimeout((e=>e.fab=!0),1500,this))}}},V=U,Y=s("9989"),Z=s("de5e"),ee=s("c294"),te=s("4396"),se=s("75c3"),re=Object(d["a"])(V,r,a,!1,null,null,null);t["default"]=re.exports;Q()(re,"components",{QPage:Y["a"],QPageSticky:Z["a"],QFab:ee["a"]}),Q()(re,"directives",{Scroll:te["a"],TouchPan:se["a"]})}}]);