(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[53],{a432:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-page",{staticClass:"q-gutter-y-sm",attrs:{padding:""}},[i("MenuGroupScroll",{model:{value:t.group,callback:function(e){t.group=e},expression:"group"}}),i("FilterInputText",{on:{text:function(e){t.filter=e}}}),i("Masonry",{attrs:{items:t.filterKeys},scopedSlots:t._u([{key:"item",fn:function(e){return[i("ItemSelectCard",{attrs:{id:e.item,price_list:t.params.price_list},on:{selected:t.addItem}})]}}])}),t.hide?t._e():i("div",{staticClass:"bg-white q-py-sm shadow-2 q-gutter-y-sm q-px-md",class:t.horizontal?"fixed-bottom":"fixed-right",staticStyle:{overflow:"scroll"},style:t.horizontal?{"max-height":"60vh"}:{width:"400px",top:"2.5rem"}},[i("OrderSeatingInfo",{attrs:{seating:t.params.seating}}),i("OrderCustomer",{attrs:{get:"id",outlined:"",dense:""},model:{value:t.params.customer,callback:function(e){t.$set(t.params,"customer",e)},expression:"params.customer"}}),i("OrderItemsSummary",{attrs:{items:t.params.items,price_list:t.params.price_list},on:{quantity:t.quantity,update:t.update,delete:t.remove}}),i("div",[i("q-btn",{staticClass:"full-width",attrs:{color:"primary",label:"Submit",disable:!t.params.items.length,loading:t.loading},on:{click:t.create}})],1)],1),i("q-page-sticky",{attrs:{position:"bottom-right",offset:[24,24]}},[t.horizontal?i("q-btn",{attrs:{fab:"",glossy:"",color:"accent",icon:"vertical_align_"+(t.hide?"top":"bottom")},on:{click:function(e){t.hide=!t.hide}}}):i("q-btn",{style:{transform:t.hide?"rotateY(180deg)":null},attrs:{fab:"",glossy:"",color:"accent",icon:"keyboard_tab"},on:{click:function(e){t.hide=!t.hide}}})],1)],1)},s=[],r=(i("a434"),i("232e")),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-virtual-scroll",{attrs:{items:t.dGroups,"virtual-scroll-horizontal":""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.item;e.index;return[i("div",{key:t.hKey(a),staticClass:"q-pa-xs cursor-pointer",on:{click:function(e){return t.$emit("input",a)}}},[i("Jumbotron",t._b({attrs:{text:a.name}},"Jumbotron",t.bindColorFont(a),!1))],1)]}}])})},o=[],l=i("b1c1"),u=i("ec70"),c=i("2f62"),m={name:"MenuGroupScroll",components:{Jumbotron:u["a"]},props:["value","groups"],computed:Object(c["d"])({dGroups({groups:{data:t},items:e}){return this.groups||_.concat([{id:0,name:"All",items:_.map(e.data,(({id:t})=>_.toInteger(t)))}],_.filter(t,["status","Active"]))}}),methods:{hKey({id:t}){return Object(l["d"])("menu","group","select",t)},bindColorFont(t){let e={color:null,font:null},i=this.value,a={color:"secondary",font:"white"};return!i&&0===t.id||i&&i.id===t.id?a:e}},created(){this.$emit("input",this.dGroups[0])}},d=m,p=i("2877"),h=i("a12b"),b=i("eebe"),f=i.n(b),y=Object(p["a"])(d,n,o,!1,null,null,null),g=y.exports;f()(y,"components",{QVirtualScroll:h["a"]});var q=i("5ab9"),v=i("7a7c"),x=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.seating?i("div",{staticClass:"row content-around"},[i("div",{staticClass:"col text-weight-bold"},[t._v("Seat"),i("div",{staticClass:"text-caption"},[t._v(t._s(t.seat.name))])]),i("div",{staticClass:"col text-weight-bold"},[t._v("Price List"),i("div",{staticClass:"text-caption"},[t._v(t._s(t.price.name))])])]):t._e()},I=[],C={name:"OrderSeatingInfo",props:["seating"],computed:{seat(){return _.get(this.$store.state.seating.data,_.toSafeInteger(this.seating))},price(){return _.get(this.$store.state.prices.list,_.toSafeInteger(this.seat.price_list))}}},S=C,$=Object(p["a"])(S,x,I,!1,null,null,null),w=$.exports,O=i("9708"),k=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-list",{attrs:{bordered:"",separator:""}},[t._l(t.items,(function(e,a){return i("q-item",{key:t.hKey(e)},[i("q-item-section",{attrs:{avatar:""}},[t._v(t._s(a+1))]),i("q-item-section",[i("q-item-label",{staticClass:"row justify-between items-center"},[i("div",{staticClass:"text-weight-bold text-grey-9"},[t._v(t._s(e.quantity)+" x "+t._s(t.item(e.item).name))])]),e.delay?i("q-item-label",{attrs:{caption:"",lines:"1"}},[t._v("Delay: "+t._s(e.delay)+" minutes")]):t._e(),e.narration?i("q-item-label",{attrs:{caption:"",lines:"1"}},[t._v(t._s(e.narration))]):t._e()],1),i("q-item-section",{attrs:{side:""}},[i("div",{staticClass:"text-bold",domProps:{textContent:t._s(t.iTotal(e))}})]),i("q-item-section",{attrs:{side:""}},[i("q-btn",{attrs:{icon:"delete",dense:"",color:"negative",flat:""},on:{click:function(i){return t.$emit("delete",e)}}}),i("q-btn",{attrs:{icon:"edit",dense:"",color:"warning",flat:""},on:{click:function(i){return t.edit(e)}}})],1)],1)})),i("q-item",[i("q-item-section",[i("q-item-label",{staticClass:"content-end"},[i("div",{staticClass:"text-weight-bold text-h6 text-grey-9"},[t._v("Total")])])],1),i("q-item-section",{attrs:{side:""}},[i("div",{staticClass:"text-h6",domProps:{textContent:t._s(t.precision(t.total,2))}})])],1),i("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:t.update_mode,callback:function(e){t.update_mode=e},expression:"update_mode"}},[t.update_obj?i("OrderItemUpdateForm",t._b({staticStyle:{width:"700px","max-width":"90vw"},on:{close:t.close,update:t.update}},"OrderItemUpdateForm",t.update_obj,!1)):t._e()],1)],2)},Q=[],j=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-card",[i("q-card-section",{staticClass:"row items-center q-pb-none"},[i("div",{staticClass:"text-h6"},[t._v("Update Order Item")]),i("q-space"),i("q-btn",{attrs:{icon:"close",flat:"",round:"",dense:""},on:{click:function(e){return t.$emit("close",null)}}})],1),i("q-card-section",{staticClass:"q-gutter-xs q-pb-none"},[i("q-input",{attrs:{dense:"",outlined:"",type:"number",label:"Quantity"},model:{value:t.quantity,callback:function(e){t.quantity=t._n(e)},expression:"quantity"}}),i("q-input",{attrs:{dense:"",outlined:"",type:"number",label:"Delay in Minutes"},model:{value:t.delay,callback:function(e){t.delay=t._n(e)},expression:"delay"}}),i("q-input",{attrs:{dense:"",type:"textarea",outlined:"",label:"Narration if any"},model:{value:t.narration,callback:function(e){t.narration=e},expression:"narration"}})],1),i("q-card-actions",{staticClass:"q-px-md q-pt-xs",attrs:{align:"right"}},[i("q-btn",{attrs:{color:"primary",label:"Update",type:"submit"},on:{click:function(e){return e.preventDefault(),t.update(e)}}})],1)],1)},N=[],F={name:"OrderItemUpdateForm",props:["item"],data(){return{quantity:1,delay:0,narration:null}},created(){_.forEach(["quantity","delay","narration"],(t=>this[t]=_.toNumber(this.$attrs[t])==this.$attrs[t]?_.toNumber(this.$attrs[t]):this.$attrs[t]))},methods:{update(){this.$emit("update",{item:_.toSafeInteger(this.item),quantity:_.toNumber(this.quantity),delay:_.toNumber(this.delay),narration:this.narration||null})}}},D=F,E=i("f09f"),K=i("a370"),U=i("2c91"),B=i("9c40"),G=i("27f9"),M=i("4b7e"),P=Object(p["a"])(D,j,N,!1,null,null,null),T=P.exports;f()(P,"components",{QCard:E["a"],QCardSection:K["a"],QSpace:U["a"],QBtn:B["a"],QInput:G["a"],QCardActions:M["a"]});var z={name:"OrderItemsSummary",components:{OrderItemUpdateForm:T},data(){return{update_mode:!1,update_obj:null}},props:["items","price_list"],computed:{price(){return _(this.$store.state.prices.data).filter(["price_list",_.toSafeInteger(this.price_list)]).mapKeys("item").mapValues("price").value()},total(){return _.sumBy(this.items,(({item:t,quantity:e})=>(_.toNumber(e)||0)*(_.toNumber(_.get(this.price,t))||0)))}},methods:{hKey({item:t}){return Object(l["d"])("order","summary","item",t)},item(t){return _.get(this.$store.state.items.data,_.toSafeInteger(t))},quantity(t,e){this.$emit("quantity",{item:t,quantity:_.toNumber(e.target.value)})},iTotal({item:t,quantity:e}){return Object(l["v"])(e*this.price[t],2)},precision(t){return Object(l["v"])(t,2)},edit(t){this.update_obj=t,this.update_mode=!0},update(t){this.$emit("update",t),this.close()},close(){this.update_mode=!1,this.update_obj=null}}},J=z,A=i("1c1c"),L=i("66e5"),V=i("4074"),R=i("0170"),Y=i("24e8"),H=Object(p["a"])(J,k,Q,!1,null,null,null),W=H.exports;f()(H,"components",{QList:A["a"],QItem:L["a"],QItemSection:V["a"],QItemLabel:R["a"],QInput:G["a"],QBtn:B["a"],QDialog:Y["a"]});var X=i("c624"),Z={name:"PageOrderCommonNew",components:{Masonry:X["a"],OrderItemsSummary:W,OrderCustomer:O["a"],OrderSeatingInfo:w,ItemSelectCard:v["a"],FilterInputText:q["a"],MenuGroupScroll:g},props:["type","customer","seating","price_list","user"],data(){return{params:{type:"Dining",customer:null,seating:null,price_list:null,user:null,items:[]},group:null,filter:null,loading:!1,hide:!0,pos:null}},computed:{items(){return this.group?this.group.items:[]},filterKeys(){return this.filter?_(this.$store.state.items.data).filter((({id:t})=>this.items.includes(t))).filter((t=>Object(l["o"])(t,["id","name","detail"],this.filter))).map("id").value():this.items},horizontal(){let{height:t,width:e}=this.$q.screen;return e<819&&t>=e}},methods:{addItem({id:t}){let e=_.find(this.params.items,["item",t]);e?e.quantity++:this.params.items.push({item:t,quantity:1,delay:0,narration:null}),this.$q.notify(`${this.params.items.length} x Items <br>${_.sumBy(this.params.items,"quantity")} x Quantities`)},quantity({item:t,quantity:e}){t=_.toSafeInteger(t),e=_.toNumber(e);let i=_.find(this.params.items,["item",t]);i?i.quantity=e:this.params.items.push({item:t,quantity:e})},remove({item:t}){let e=_.findIndex(this.params.items,["item",_.toSafeInteger(t)]);e>-1&&this.params.items.splice(e,1)},update(t){let e=_.find(this.params.items,["item",t.item]);if(!e)return null;_.forEach(_.omit(t,"item"),((t,i)=>e[i]=t))},create(){let t=this;t.loading=!0,post("token","create",t.params).then((e=>{t.loading=!1,t.$router.push({name:"orders"})}))},hKey(t){return Object(l["d"])("common","order","group",this.group.id,"item",t)}},created(){let t=this,e=r["OrderTypeRequiredFieldsDB"][t.type||"Dining"];_.forEach(e,(e=>t.params[e]=t[e])),this.$q.notify.setDefaults({position:"top-right",timeout:1e3,color:"positive",group:!1,html:!0,caption:"Items Updated !!"})}},tt=Z,et=i("9989"),it=i("de5e"),at=Object(p["a"])(tt,a,s,!1,null,null,null);e["default"]=at.exports;f()(at,"components",{QPage:et["a"],QBtn:B["a"],QPageSticky:it["a"]})}}]);