(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[54],{"572d":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{attrs:{padding:""}},[a("OrderNewGlobal",t._b({attrs:{seat:t.seat}},"OrderNewGlobal",t.$attrs,!1)),a("q-dialog",{attrs:{value:t.m_show,persistent:""}},[a("MenuSelect",{style:t.popup_width})],1)],1)},i=[],r=a("ded3"),n=a.n(r),o=a("fdfe"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card",{attrs:{flat:"",square:""}},[!t.seat||t.tab&&"seating"!==t.tab?a("q-card-section",{staticClass:"q-px-none"},[t.quick?[a("QuickOrder",{attrs:{items:t.params.items,price_list:t.params.price_list},on:{item:t.item,done:function(e){t.tab="proceed"}}})]:[a("FilterInputText",{staticClass:"q-mb-xs",on:{text:function(e){t.item_filter=e}}}),a("GroupItemsSelect",{attrs:{selected:t.active_group,filter:t.item_filter,price_list:t.params.price_list,type:t.params.type},on:{item:t.item}})]],2):a("q-card-section",{staticClass:"q-px-none"},[a("SeatSelect",{on:{selected:t.seating}})],1),t.quick?t._e():[a("q-tabs",{staticClass:"fixed-bottom bg-primary",attrs:{align:"justify",dense:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[t.seat?a("q-tab",{staticClass:"text-white",attrs:{name:"seating",icon:"event_seat",label:"Seat"}}):t._e(),a("q-tab",{staticClass:"text-white",attrs:{name:"items",icon:"widgets",label:"Items"}}),a("q-tab",{staticClass:"text-white",attrs:{name:"proceed",icon:"forward",label:"Proceed"}})],1),a("GroupStickyButton",{style:{visibility:!t.seat||t.tab&&"seating"!==t.tab?"visible":"hidden"},attrs:{type:t.params.type},model:{value:t.active_group,callback:function(e){t.active_group=e},expression:"active_group"}})],a("q-dialog",{attrs:{persistent:"",value:"proceed"===t.tab},on:{"before-hide":function(e){t.tab="items"}}},[a("OrderNewSummary",t._b({style:t.popup_width(),attrs:{loading:t.loading},on:{process:t.process}},"OrderNewSummary",t.params,!1))],1)],2)},l=[],m=(a("a434"),a("ddb0"),a("5ab9")),u=a("47ac"),p=a("40f6"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("FilterInputText",{staticClass:"q-mb-xs",attrs:{label:"Filter Seats"},on:{text:function(e){t.filter=e}}}),a("Masonry",{attrs:{items:t.seats,width:"180"},scopedSlots:t._u([{key:"item",fn:function(e){return[a("SeatSelectItem",{staticClass:"cursor-pointer",attrs:{id:e.id},on:{selected:function(a){return t.$emit("selected",e)}}})]}}])})],1)},h=[],b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card",{on:{click:function(e){return t.$emit("selected",t.seat)}}},[a("q-card-section",{staticClass:"q-py-xs bg-grey"}),a("CardImageTitle",{attrs:{title:t.seat.name,image:t.src}})],1)},f=[],q=a("b1c1"),g=a("43fa"),v={name:"SeatSelectItem",components:{CardImageTitle:g["a"]},props:["id"],computed:{seat(){return _.get(this.$store.state.seating.data,_.toSafeInteger(this.id))},src(){return Object(q["h"])(this.seat.image)}}},y=v,x=a("2877"),w=a("f09f"),S=a("a370"),C=a("eebe"),O=a.n(C),Q=Object(x["a"])(y,b,f,!1,null,null,null),I=Q.exports;O()(Q,"components",{QCard:w["a"],QCardSection:S["a"]});var k=a("c624"),$={name:"SeatSelect",components:{Masonry:k["a"],FilterInputText:m["a"],SeatSelectItem:I},data(){return{filter:""}},computed:{s_seats(){return _(this.$store.state.seating.data).filter(["status","Active"]).value()},seats(){return this.filter?_.filter(this.s_seats,(t=>Object(q["q"])(t,["id","name","detail"],this.filter))):this.s_seats}},methods:{hKey({id:t}){return Object(q["e"])("seat","select","item",t)}}},j=$,T=Object(x["a"])(j,d,h,!1,null,null,null),F=T.exports,N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card",[a("q-bar",{staticClass:"text-white q-py-lg items-center",class:"bg-"+t.clr},[a("q-icon",{attrs:{name:"receipt",color:"white",left:""}}),a("span",[t._v("Order Summary")]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"clear",flat:"",round:"",color:"white"}})],1),a("q-card-section",{staticClass:"q-pa-none"},[a("q-list",{staticStyle:{"font-size":"0.75rem"},attrs:{dense:"",separator:"",bordered:""}},[a("q-item",[a("q-item-section",{attrs:{avatar:""}},[t._v("No")]),a("q-item-section",[t._v("Item")]),a("q-item-section",{attrs:{side:""}},[t._v("Total")]),a("q-item-section",{attrs:{side:""}},[a("q-icon",{attrs:{name:"clear",color:"white",size:"xs"}})],1)],1),t._l(t.items,(function(e,s){return a("q-item",{key:t.h_key("ons-oi",s,"i",e.item)},[a("q-item-section",{attrs:{avatar:""}},[t._v(t._s(s+1))]),a("q-item-section",[a("q-item-label",[t._v(t._s(t.iData(e,"name")))]),a("q-item-label",{staticStyle:{"font-size":"0.65rem"},attrs:{caption:""}},[t._v(t._s(e.quantity)+" x "+t._s(parseFloat(t.price[e.item]).toFixed(2)))])],1),a("q-popup-edit",{attrs:{value:t.items.quantity,title:t.iData(e,"name"),"auto-save":""},on:{input:function(e){return t.$emit("process",["quantity",s,e])}}},[a("q-input",{attrs:{type:"number",value:e.quantity,dense:"",outlined:"",autofocus:"",label:"Quantity"},on:{input:function(e){return t.$emit("process",["quantity",s,e])}}})],1),a("q-item-section",{attrs:{side:""}},[t._v(t._s(parseFloat(t.price[e.item]*e.quantity).toFixed(2)))]),a("q-item-section",{attrs:{side:""}},[a("q-icon",{attrs:{name:"clear",color:"negative",size:"xs"},on:{click:function(e){return t.$emit("process",["remove",s])}}})],1)],1)})),a("q-item",{staticClass:"text-white",attrs:{dense:""}},[a("q-item-section",{attrs:{avatar:""}},[t._v("0")]),a("q-item-section",[a("q-item-label",{staticClass:"text-white"},[t._v("Total")])],1),a("q-item-section",{staticClass:"text-bold",class:"text-"+t.clr,attrs:{side:""}},[t._v(t._s(parseFloat(t.total).toFixed(2)))]),a("q-item-section",{attrs:{side:""}},[a("q-icon",{attrs:{name:"attach_money",color:t.clr,size:"xs"}})],1)],1)],2)],1),a("q-card-section",[a("OrderCustomer",{attrs:{get:"id",outlined:"",dense:""},model:{value:t.v_customer,callback:function(e){t.v_customer=e},expression:"v_customer"}})],1),a("q-card-actions",{staticClass:"bg-grey-2",attrs:{align:"right"}},[a("q-btn",{attrs:{label:"Submit",color:t.clr,padding:"xs md",loading:t.loading},on:{click:function(e){return t.$emit("process",["submit"])}}})],1)],1)},E=[],G=(a("13d5"),a("2f62")),z=a("9708"),D={name:"OrderNewSummary",components:{OrderCustomer:z["a"]},props:["items","price_list","customer","color","loading"],computed:n()(n()({},Object(G["d"])("items",{item_master:"data"})),{},{clr(){return this.color||"accent"},price(){return _.get(this.$store.getters["prices/items"],_.toInteger(this.price_list))},total(){return _.reduce(this.items,((t,{item:e,quantity:a})=>t+this.price[e]*a),0)},v_customer:{get(){return this.customer},set(t){this.$emit("process",["customer",t])}}}),methods:{h_key:q["e"],iData({item:t},e){return _.get(this.item_master,[_.toInteger(t),e])}}},P=D,B=a("d847"),M=a("0016"),A=a("2c91"),J=a("9c40"),L=a("1c1c"),K=a("66e5"),U=a("4074"),H=a("0170"),R=a("42a1"),V=a("27f9"),W=a("4b7e"),X=a("7f67"),Y=Object(x["a"])(P,N,E,!1,null,null,null),Z=Y.exports;O()(Y,"components",{QCard:w["a"],QBar:B["a"],QIcon:M["a"],QSpace:A["a"],QBtn:J["a"],QCardSection:S["a"],QList:L["a"],QItem:K["a"],QItemSection:U["a"],QItemLabel:H["a"],QPopupEdit:R["a"],QInput:V["a"],QCardActions:W["a"]}),O()(Y,"directives",{ClosePopup:X["a"]});var tt=a("4064"),et=a("514b"),at={name:"OrderNewGlobal",components:{QuickOrder:tt["a"],OrderNewSummary:Z,SeatSelect:F,GroupStickyButton:p["a"],GroupItemsSelect:u["a"],FilterInputText:m["a"]},mixins:[et["a"]],data(){return{tab:"",active_group:0,item_filter:"",params:{type:null,seating:null,price_list:null,customer:null,items:[],user:null,narration:null},loading:!1}},props:["seat","after"],computed:{attrs(){return _.pick(this.$attrs,_.keys(this.params))}},methods:{popup_width:q["x"],item({id:t}){let e=_.find(this.params.items,["item",t]);e?e.quantity++:this.params.items.push({item:t,quantity:1,delay:0,narration:null}),this.quick||this.$q.notify({type:"positive",message:"Item Updated",caption:`Total ${this.params.items.length} Items`,group:"items",position:"top-right"})},seating({id:t,price_list:e}){this.params.seating=t,this.params.price_list=e,this.tab="items"},init(t){let e=this;_.forEach(t,(function(t,a){e.params[a]=t}))},process(t){this[_.head(t)]["apply"](this,_.tail(t))},quantity(t,e){this.params.items[t]["quantity"]=e},remove(t){this.params.items.splice(t,1)},customer(t){this.params.customer=t},submit(){_.isEmpty(this.params.items)||(this.loading=!0,post("token","create",this.params).then((()=>{if(this.params.items.splice(0,this.params.items.length),this.item_filter="",this.active_group=0,this.init(this.attrs),this.loading=!1,this.tab="items",this.after)return this.$router.push(_.isObject(this.after)?this.after:{name:this.after});this.seat&&setTimeout((t=>t.tab="seating"),600,this)})))}},watch:{attrs:{immediate:!0,deep:!0,handler:"init"}}},st=at,it=a("429b"),rt=a("7460"),nt=a("24e8"),ot=Object(x["a"])(st,c,l,!1,null,null,null),ct=ot.exports;O()(ot,"components",{QCard:w["a"],QCardSection:S["a"],QTabs:it["a"],QTab:rt["a"],QDialog:nt["a"]});var lt={name:"PageOrderNew",components:{OrderNewGlobal:ct,MenuSelect:o["a"]},props:["seat"],computed:n()({popup_width(){return Object(q["x"])()}},Object(G["d"])("menus",{m_show:t=>!t.s_items.length}))},mt=lt,ut=a("9989"),pt=Object(x["a"])(mt,s,i,!1,null,null,null);e["default"]=pt.exports;O()(pt,"components",{QPage:ut["a"],QDialog:nt["a"]})}}]);