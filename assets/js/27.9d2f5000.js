(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[27],{"22b3":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{attrs:{padding:""}},[s("Masonry",{attrs:{width:"300",items:t.pBills},scopedSlots:t._u([{key:"item",fn:function(e){return[s("BillDetailCard",t._b({},"BillDetailCard",e,!1))]}}])})],1)},i=[],n=s("b1c1"),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-card",[s("q-card-section",{staticClass:"q-pa-xs",class:t.bgCls}),s("q-list",{attrs:{dense:""}},[t._l(t.header,(function(e,a){return s("q-item",{key:t.hKey("header",e),attrs:{dense:""}},[s("q-item-section",[t._v(t._s(a))]),s("q-item-section",{attrs:{side:""}},[t._v(t._s(t.attrs(e)))])],1)})),s("q-item",[s("q-item-section",[t._v("Customer")]),s("q-item-section",{attrs:{side:""}},[t._v(t._s(t.attrs("customer.name")))])],1)],2),s("q-list",{attrs:{bordered:""}},t._l(t.contents,(function(e){return s("q-item",{key:t.hKey("content",e.id)},[s("q-item-section",[s("q-item-label",[t._v(t._s(e.name))]),s("q-item-label",{attrs:{caption:""}},[t._v(t._s(e.quantity)+" x "+t._s(t.precision(e.price)))]),e.tax?s("q-item-section",[s("q-item-label",{attrs:{caption:""}},[t._v("\n            "+t._s(e.tax.name)+" "+t._s(t.precision(e.tax.amount))+" @"+t._s(e.tax.percent)+"%\n          ")]),t._l(e.tax.contents,(function(e){return s("q-item-label",{key:t.hKey("tax",Math.random()),attrs:{caption:""}},[t._v("\n            - "+t._s(e.name)+" "+t._s(t.precision(e.amount))+" @"+t._s(e.percent)+"%\n          ")])}))],2):t._e()],1),s("q-item-section",{attrs:{side:""}},[s("q-item-label",[t._v(t._s(t.precision(t.getTotal(e))))])],1)],1)})),1),s("q-list",{attrs:{dense:"",bordered:""}},[s("q-item",{attrs:{dense:""}},[s("q-item-section",[t._v("Sub Total")]),s("q-item-section",{staticClass:"text-bold",attrs:{side:""}},[t._v(t._s(t.precision(t.total)))])],1),s("q-item",{attrs:{dense:""}},[s("q-item-section",[t._v("Discount")]),s("q-item-section",{staticClass:"text-bold",attrs:{side:""}},[t._v(t._s(t.precision(t.discount)))])],1),s("q-item",{staticStyle:{"font-size":"1rem"},attrs:{dense:""}},[s("q-item-section",[t._v("Net Payable")]),s("q-item-section",{staticClass:"text-bold",attrs:{side:""}},[t._v(t._s(t.precision(t.attrs("payable"))))])],1),t.paid>0?s("q-item",{staticStyle:{"font-size":"1rem"},attrs:{dense:""}},[s("q-item-section",[t._v("Total Paid")]),s("q-item-section",{staticClass:"text-bold",attrs:{side:""}},[t._v(t._s(t.precision(t.paid)))])],1):t._e()],1),s("q-card-actions",{staticClass:"q-gutter-y-xs",attrs:{vertical:"",align:"center"}},[s("q-select",{staticClass:"full-width",attrs:{outlined:"",options:t.options,label:"Type"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}}),s("q-input",{staticClass:"full-width",attrs:{outlined:"",type:"number",label:"Amount"},model:{value:t.balance,callback:function(e){t.balance=t._n(e)},expression:"balance"}}),s("q-btn",{staticClass:"full-width",attrs:{label:"Make Payment",color:"primary",loading:t.loading},on:{click:t.pay}})],1),s("q-inner-loading",{attrs:{showing:t.loading}},[s("q-spinner-facebook",{attrs:{color:"primary",size:"2em"}})],1)],1)},l=[],o=s("232e"),c={name:"BillDetailCard",data(){return{header:{"Bill ID":"id",Token:"token.id",Type:"token.type",Date:"date"},v_amount:0,loading:!1,options:o["f"],type:o["f"][0]}},computed:{bgCls(){return"bg-"+o["a"][this.attrs("token.type")]},contents(){return this.attrs("contents",[])},total(){return _.sum(_.map(this.contents,this.getTotal))},discount(){return _.sum(_.map(this.contents,(({discount:t})=>_.toNumber(t))))},paid(){return _.toNumber(this.attrs("paid",0))},balance:{get(){return this.v_amount||this.total-this.discount-this.paid},set(t){this.v_amount=_.toNumber(t)}}},methods:{hKey(t,e){return Object(n["d"])("bill",this.attrs("id"),"details",t,e)},attrs(t,e){return _.get(this.$attrs,t,e)},precision(t){return Object(n["n"])(t)},getTotal({price:t,quantity:e}){return _.toNumber(t)*_.toNumber(e)},pay(){if(this.loading=!0,!this.attrs("id")||!this.balance)return this.loading=!1;let t={bill:this.attrs("id"),amount:this.balance,type:this.type};post("payment","create",t).then().catch().then((()=>this.loading=!1))}}},d=c,m=s("2877"),u=s("f09f"),p=s("a370"),b=s("1c1c"),h=s("66e5"),q=s("4074"),y=s("0170"),f=s("4b7e"),g=s("ddd8"),v=s("27f9"),C=s("9c40"),x=s("74f7"),k=s("e669"),Q=s("eebe"),w=s.n(Q),B=Object(m["a"])(d,r,l,!1,null,null,null),P=B.exports;w()(B,"components",{QCard:u["a"],QCardSection:p["a"],QList:b["a"],QItem:h["a"],QItemSection:q["a"],QItemLabel:y["a"],QCardActions:f["a"],QSelect:g["a"],QInput:v["a"],QBtn:C["a"],QInnerLoading:x["a"],QSpinnerFacebook:k["a"]});var S=s("58d1"),T=s("c624"),D={name:"PageBillPending",mixins:[S["a"]],components:{Masonry:T["a"],BillDetailCard:P},computed:{pBills(){return _.filter(this.bills,(({progress:t})=>["Pending","Partial"].includes(t)))}},methods:{hKey({id:t}){return Object(n["d"])("bill","details","bill",t)}}},I=D,N=s("9989"),j=Object(m["a"])(I,a,i,!1,null,null,null);e["default"]=j.exports,w()(j,"components",{QPage:N["a"]})}}]);