(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[38],{8443:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("q-page",{staticClass:"q-gutter-y-sm",attrs:{padding:""}},[e("KitchenItemDayProcess"),e("KitchenItemAcceptable"),e("div",{staticClass:"row q-col-gutter-sm q-mt-xs"},[e("div",{staticClass:"col-xs-12 col-sm-6"},[e("KitchenItemLeastStock")],1),e("div",{staticClass:"col-xs-12 col-sm-6"},[e("KitchenItemDayMostProcessing")],1)])],1)},a=[],n=function(){var t=this,e=t._self._c;return e("q-card",{staticClass:"q-pa-none"},[e("q-card-section",{staticClass:"bg-grey-1"},[e("div",{staticClass:"text-bold"},[t._v("Kitchens")])]),e("q-card-section",[e("q-list",t._l(t.kitchens,(function(s){return e("q-item",{key:"ka-kitchen-"+s.id},[e("q-item-section",[e("q-item-label",[t._v(t._s(s.name))]),e("q-item-label",{attrs:{caption:""}},[t._v("Auto Accept: "+t._s(s.auto_accept))]),s.detail?e("q-item-label",{attrs:{caption:""}},[t._v(t._s(s.detail))]):t._e()],1)],1)})),1)],1)],1)},c=[],r=s("2f62"),o={name:"KitchenAssigned",computed:Object(r["d"])("kitchens",{kitchens:({data:t,assign:e})=>_.map(e,(e=>_.get(t,_.toInteger(e))))})},l=o,m=s("2877"),d=s("f09f"),u=s("a370"),h=s("1c1c"),p=s("66e5"),g=s("4074"),k=s("0170"),b=s("eebe"),q=s.n(b),v=Object(m["a"])(l,n,c,!1,null,null,null),f=v.exports;q()(v,"components",{QCard:d["a"],QCardSection:u["a"],QList:h["a"],QItem:p["a"],QItemSection:g["a"],QItemLabel:k["a"]});var y=function(){var t=this,e=t._self._c;return e("div",{staticClass:"row q-col-gutter-xs"},[e("div",{staticClass:"col-xs-6 col-sm-3"},[e("DigitMetric",{attrs:{value:t.tokens.length,title:"Tokens",bg:"cyan",text:"white"}})],1),e("div",{staticClass:"col-xs-6 col-sm-3"},[e("DigitMetric",{attrs:{value:t.items.length+"("+t.quantities+")",title:"Items & Quantities",bg:"blue",text:"white"}})],1),e("div",{staticClass:"col-xs-6 col-sm-3"},[e("DigitMetric",{attrs:{value:t.pending,title:"In Processing",bg:"orange",text:"white"}})],1),e("div",{staticClass:"col-xs-6 col-sm-3"},[e("DigitMetric",{attrs:{value:t.completed,title:"Completed",bg:"green",text:"white"}})],1)])},C=[],I=(s("caad"),s("84ba")),x={name:"KitchenItemDayProcess",components:{DigitMetric:I["a"]},data(){return{process_progress:["Accepted","Processing","Completed","Served"]}},computed:{...Object(r["b"])("tokens",["today"]),...Object(r["d"])({tokens:function({tokens:{items:t}}){return _.map(this.today,(e=>Object.assign({},e,{items:t[e.id]})))},kitchens:function({kitchens:{assign:t,data:e}}){return _.map(t,(t=>e[t]))}}),kids(){return _.map(this.kitchens,"id")},items(){return _.flatMap(this.tokens,(({items:t})=>_.filter(t,(({kitchen:t,progress:e})=>this.kids.includes(t)&&this.process_progress.includes(e)))))},quantities(){return _.sumBy(this.items,(({quantity:t})=>_.toNumber(t)))},pending(){return _.sumBy(this.items,(({quantity:t,progress:e})=>"Processing"===e?_.toNumber(t):0))},completed(){return _.sumBy(this.items,(({quantity:t,progress:e})=>["Completed","Served"].includes(e)?_.toNumber(t):0))}}},Q=x,w=Object(m["a"])(Q,y,C,!1,null,null,null),K=w.exports,j=function(){var t=this,e=t._self._c;return e("q-card",{staticClass:"q-pa-none"},[e("q-card-section",{staticClass:"bg-grey-2"},[e("div",{staticClass:"text-bold"},[t._v("Most Processing Items")])]),t.items.length?e("q-table",{attrs:{data:t.items,columns:t.columns,dense:"",pagination:{rowsPerPage:40},"rows-per-page-label":"Items per page"}}):e("q-card-actions",{attrs:{align:"center"}},[t._v("No items processed yet")])],1)},O=[],S=s("3758"),M={name:"KitchenItemDayMostProcessing",mixins:[S["a"]],data(){return{columns:[{name:"item",label:"Item",field:"item",align:"left",sortable:!0},{name:"quantity",label:"Quantity",field:"quantity",align:"left",sortable:!0},{name:"time",label:"Total Time",field:"time",align:"left",sortable:!0,format:t=>t<60?t+" secs":_.floor(t/60)+" mins"},{name:"average",label:"Average",field:"time",align:"left",sortable:!0,format(t,{quantity:e}){let s=_.round(t/e);return s<60?s+" secs":_.floor(s/60)+" mins"}}]}},computed:{...Object(r["b"])({today:"tokens/today",kitchens:"kitchens/assign"}),items(){let t=_.map(this.today,"id")||[];return _.map(_.groupBy(_.flatMap(this.tokens,(({items:e,id:s})=>_.includes(t,s)?_.filter(e,(({kitchen:t,progress:e})=>t&&_.includes(this.kitchens[_USER.id],t.id)&&"Cancelled"!==e)):[])),"item.id"),((t,e)=>_.zipObject(["item","quantity","time"],[_.get(t,[0,"item","name"]),_.sumBy(t,"quantity"),this.pTime(t)])))}},methods:{pTime(t){return _.sumBy(t,(({progress_timing:t})=>{let e=_.find(t,["status","Processing"]),s=_.find(t,["status","Completed"]);return e&&s?_.toInteger(_.get(s,"time"))-_.toInteger(_.get(e,"time")):0}))}}},P=M,A=s("eaac"),D=s("4b7e"),L=Object(m["a"])(P,j,O,!1,null,null,null),B=L.exports;q()(L,"components",{QCard:d["a"],QCardSection:u["a"],QTable:A["a"],QCardActions:D["a"]});var N=function(){var t=this,e=t._self._c;return e("q-card",{staticClass:"q-pa-none"},[e("q-card-section",{staticClass:"bg-grey-2"},[e("div",{staticClass:"text-bold"},[t._v("Least Stock Items")])]),t.sorted.length?e("q-list",{attrs:{dense:"",separator:""}},t._l(t.sorted,(function(s,i){return e("q-item",{key:"kils-"+i},[e("q-item-section",{attrs:{avatar:""}},[t._v(t._s(i+1))]),e("q-item-section",[e("q-item-label",[t._v(t._s(s.item))]),e("q-item-label",{attrs:{caption:""}},[t._v(t._s(s.kitchen))])],1),e("q-item-section",{staticClass:"text-bold",class:{"text-warning":s.stock>0,"text-negative":s.stock<1},attrs:{side:""}},[t._v(t._s(s.stock))])],1)})),1):e("q-card-actions",{attrs:{align:"center"}},[t._v("No items with less stock")])],1)},T=[],z={name:"KitchenItemLeastStock",computed:{...Object(r["d"])({kitchens:({kitchens:{data:t,assign:e}})=>_(e).mapKeys((t=>t)).mapValues((e=>t[e])).value(),items:function({kitchens:{items:t,assign:e},items:{data:s}}){return _(_.pick(t,e)).flatMap().filter((({stock:t})=>t<8)).map((t=>_.zipObject(["item","kitchen","stock"],[s[t.item].name,this.kitchens[t.kitchen].name,t.stock]))).value()}}),sorted(){return _.sortBy(this.items,"stock")}}},V=z,E=Object(m["a"])(V,N,T,!1,null,null,null),G=E.exports;q()(E,"components",{QCard:d["a"],QCardSection:u["a"],QList:h["a"],QItem:p["a"],QItemSection:g["a"],QItemLabel:k["a"],QCardActions:D["a"]});var J=function(){var t=this,e=t._self._c;return e("q-card",{staticClass:"q-pa-none"},[e("q-card-section",{staticClass:"bg-grey-2 row justify-between text-bold"},[e("div",[t._v("Acceptable Token Items")]),t.items.length?e("div",[t._v(t._s(t.items.length))]):t._e()]),t.items.length?e("q-list",{attrs:{separator:""}},t._l(t.items,(function(s,i){return e("q-item",{key:t.hKey(s,i)},[e("q-item-section",{attrs:{avatar:""}},[e("q-badge",{staticClass:"q-pa-sm shadow-2",attrs:{label:s.token,color:"primary"}})],1),e("q-item-section",[e("q-item-label",[e("span",{staticClass:"text-weight-bolder"},[t._v(t._s(s.quantity))]),t._v(" x "+t._s(s.item_name))]),e("q-item-label",{class:t.kColor(s),attrs:{caption:""}},[t._v(t._s(s.kitchen_name))]),e("q-item-label",{attrs:{caption:""}},[t._v("Stock: "+t._s(s.stock))])],1),e("q-item-section",{attrs:{side:""}},[e("q-btn",{staticStyle:{transform:"rotateY(180deg)"},attrs:{icon:"reply_all",round:"",color:"positive"},on:{click:function(e){return t.accept(s)}}})],1)],1)})),1):e("q-card-actions",{attrs:{align:"center"}},[t._v("No Items")]),t.loading?e("q-inner-loading",{attrs:{showing:!0}},[e("q-spinner-facebook",{attrs:{color:"primary",size:"2em"}})],1):t._e()],1)},R=[],U=(s("14d9"),s("b1c1")),F={name:"KitchenItemAcceptable",data(){return{Colors:["accent","info","deep-purple-10","red-10","indigo-10","cyan-5","green-6","teal-5"],kitchens:[],loading:!1}},computed:{assign(){return this.$store.getters["kitchens/assign"][parseInt(_USER.id)]},...Object(r["d"])({kItems:function({kitchens:{items:t}}){return _(_.pick(t,this.assign)).flatMap().groupBy("item").mapValues(this.iGroup).value()},tItems:function({tokens:{items:t}}){return _(t).flatMap().filter(["progress","New"]).value()},IK:function(t){return _.mapValues({kitchen:"kitchens",item:"items"},(e=>_.mapValues(t[e].data,"name")))}}),items(){return _.flatMap(this.tItems,(({id:t,item:e,quantity:s,token:i})=>_.has(this.kItems,e)?_.map(this.kItems[e],(e=>Object.assign({},e,{id:t,token:i,quantity:s}))):[]))}},methods:{iGroup(t){return _(t).map((({item:t,kitchen:e,stock:s})=>_.zipObject(["item","kitchen","stock","item_name","kitchen_name"],[t,e,s,_.get(this.IK,["item",t]),_.get(this.IK,["kitchen",e])]))).value()},hKey({item:t,kitchen:e},s){return Object(U["e"])("kitchen","item","acceptable",s,"kitchen",e,"item",t)},kColor({kitchen:t}){return this.kitchens.includes(t)?"text-"+this.Colors[this.kitchens.indexOf(t)]:this.kColor({kitchen:t,add:this.kitchens.push(t)})},accept({id:t,kitchen:e}){this.loading=!0,post("token","accept",{id:t,kitchen:e}).then((()=>this.loading=!1))}},watch:{items(t,e){(!e||t.length>e.length)&&Object(U["b"])()}}},Y=F,$=s("58a8"),H=s("9c40"),W=s("74f7"),X=s("e669"),Z=Object(m["a"])(Y,J,R,!1,null,null,null),tt=Z.exports;q()(Z,"components",{QCard:d["a"],QCardSection:u["a"],QList:h["a"],QItem:p["a"],QItemSection:g["a"],QBadge:$["a"],QItemLabel:k["a"],QBtn:H["a"],QCardActions:D["a"],QInnerLoading:W["a"],QSpinnerFacebook:X["a"]});var et={name:"PageChefIndex",components:{KitchenItemAcceptable:tt,KitchenItemLeastStock:G,KitchenItemDayMostProcessing:B,KitchenItemDayProcess:K,KitchenAssigned:f}},st=et,it=s("9989"),at=Object(m["a"])(st,i,a,!1,null,null,null);e["default"]=at.exports;q()(at,"components",{QPage:it["a"]})}}]);