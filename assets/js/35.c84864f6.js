(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[35],{"572d":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{attrs:{padding:""}},[s("q-splitter",{staticStyle:{height:"85vh"},attrs:{horizontal:t.horizontal},scopedSlots:t._u([{key:"before",fn:function(){return[s("q-card",[s("q-tabs",{staticClass:"text-grey",attrs:{"active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[s("q-tab",{attrs:{name:"seating",label:"Seating"}}),s("q-tab",{attrs:{name:"items",label:"Items"}})],1),s("q-separator"),s("q-tab-panels",{attrs:{animated:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[s("q-tab-panel",{attrs:{name:"seating"}},[s("SeatSelect",{on:{selected:t.seat}})],1),s("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"items"}},[s("q-splitter",{scopedSlots:t._u([{key:"before",fn:function(){return[s("MenuGroupTabs",{staticStyle:{height:"85vh"},on:{selected:function(e){t.group=e}}})]},proxy:!0},{key:"after",fn:function(){return[s("div",{staticClass:"q-px-md q-pt-xs"},[s("FilterInputText",{on:{text:function(e){t.item_filter=e}}})],1),s("GroupItemsPanel",t._b({staticStyle:{height:"85vh"},attrs:{selected:t.group?t.group.id:null,filter:t.item_filter},on:{item:t.item}},"GroupItemsPanel",t.params,!1))]},proxy:!0}]),model:{value:t.iSplit,callback:function(e){t.iSplit=e},expression:"iSplit"}})],1)],1)],1)]},proxy:!0},{key:"after",fn:function(){return[s("OrderSeatingInfo",{staticClass:"q-mt-sm q-px-md",attrs:{seating:t.params.seating}}),s("OrderCustomer",{staticClass:"q-mt-sm q-px-md",attrs:{get:"id"},model:{value:t.params.customer,callback:function(e){t.$set(t.params,"customer",e)},expression:"params.customer"}}),s("OrderItemsSummary",{staticClass:"q-ma-sm",attrs:{items:t.params.items,price_list:t.params.price_list},on:{quantity:t.quantity,update:t.update,delete:t.remove}}),s("div",{staticClass:"q-mt-sm q-px-md"},[s("q-btn",{staticClass:"full-width",attrs:{color:"primary",label:"Submit",disable:!t.params.items.length,loading:t.loading},on:{click:t.create}})],1)]},proxy:!0}]),model:{value:t.split,callback:function(e){t.split=e},expression:"split"}}),t.order_info?s("q-page-sticky",{attrs:{position:"bottom-right",offset:[24,24]}},[t.horizontal?s("q-btn",{attrs:{fab:"",glossy:"",color:"accent",icon:"vertical_align_"+(t.hide?"top":"bottom")},on:{click:function(e){t.hide=!t.hide}}}):s("q-btn",{style:{transform:t.hide?"rotateY(180deg)":null},attrs:{fab:"",glossy:"",color:"accent",icon:"keyboard_tab"},on:{click:function(e){t.hide=!t.hide}}})],1):t._e(),s("q-dialog",{attrs:{persistent:""},model:{value:t.m_show,callback:function(e){t.m_show=e},expression:"m_show"}},[s("MenuSelect",{staticStyle:{width:"75vw","max-width":"330px"}})],1)],1)},i=[],r=(s("a434"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"q-col-gutter-xs"},[s("FilterInputText",{attrs:{label:"Filter Seats"},on:{text:function(e){t.filter=e}}}),s("Masonry",{attrs:{items:t.seats,width:"180"},scopedSlots:t._u([{key:"item",fn:function(e){return[s("SeatSelectItem",{staticClass:"cursor-pointer",attrs:{id:e.id},on:{selected:function(s){return t.$emit("selected",e)}}})]}}])})],1)}),n=[],l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-card",{on:{click:function(e){return t.$emit("selected",t.seat)}}},[s("q-card-section",{staticClass:"q-py-xs bg-grey"}),s("CardImageTitle",{attrs:{title:t.seat.name,image:t.src}})],1)},o=[],c=s("b1c1"),u=s("43fa"),m={name:"SeatSelectItem",components:{CardImageTitle:u["a"]},props:["id"],computed:{seat(){return _.get(this.$store.state.seating.data,_.toSafeInteger(this.id))},src(){return Object(c["e"])(this.seat.image)}}},p=m,d=s("2877"),h=s("f09f"),f=s("a370"),g=s("eebe"),b=s.n(g),y=Object(d["a"])(p,l,o,!1,null,null,null),q=y.exports;b()(y,"components",{QCard:h["a"],QCardSection:f["a"]});var S=s("5ab9"),v=s("c624"),x={name:"SeatSelect",components:{Masonry:v["a"],FilterInputText:S["a"],SeatSelectItem:q},data(){return{filter:""}},computed:{s_seats(){return this.$store.state.seating.data},seats(){return this.filter?_.filter(this.s_seats,this.filtered):this.s_seats}},methods:{hKey({id:t}){return Object(c["d"])("seat","select","item",t)},filtered({id:t,name:e,detail:s}){return[t,e,s].join(" ").toLowerCase().includes(this.filter.toLowerCase())}}},w=x,I=Object(d["a"])(w,r,n,!1,null,null,null),C=I.exports,k=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-scroll-area",[s("div",{staticClass:"row text-center q-col-gutter-y-xs q-pa-xs text-primary"},[s("div",{staticClass:"col-12",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.$emit("selected",null)}}},[s("Jumbotron",{attrs:{text:"All"}})],1),t._l(t.groups,(function(e){return s("div",{key:t.hKey(e),staticClass:"col-12",staticStyle:{cursor:"pointer"},on:{click:function(s){return t.$emit("selected",e)}}},[s("Jumbotron",{attrs:{text:e.name}})],1)}))],2)])},Q=[],$=(s("5db7"),s("73d9"),s("ec70")),O={name:"MenuGroupTabs",components:{Jumbotron:$["a"]},data(){return{tab:"all"}},computed:{menus(){return this.$store.state.menus.s_items},m_groups(){return _.flatMap(_.pick(this.$store.state.menus.data,this.menus),(({groups:t})=>_.map(t,_.toSafeInteger)))},groups(){return _.pick(this.$store.state.groups.data,this.m_groups)}},methods:{hKey({id:t}){return Object(c["d"])("menu","group","select",t)}}},j=O,M=s("4983"),T=Object(d["a"])(j,k,Q,!1,null,null,null),P=T.exports;b()(T,"components",{QScrollArea:M["a"]});var K=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-tab-panels",{attrs:{animated:"","transition-prev":"slide-down","transition-next":"slide-up"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[s("q-tab-panel",{staticClass:"row q-col-gutter-xs",attrs:{name:"group-all"}},[s("Masonry",{attrs:{items:t.all_items,width:"180"},scopedSlots:t._u([{key:"item",fn:function(e){return[s("ItemSelectCard",{attrs:{id:e.item,price_list:t.price_list},on:{selected:function(e){return t.$emit("item",e)}}})]}}])})],1),t._l(t.m_groups,(function(e){return s("q-tab-panel",{key:t.hKey({id:e},"group"),staticClass:"row q-col-gutter-xs",attrs:{name:"group-"+e}},[s("Masonry",{attrs:{items:t.groupItems(e),width:"180"},scopedSlots:t._u([{key:"item",fn:function(e){return[s("ItemSelectCard",{attrs:{id:e.item,price_list:t.price_list},on:{selected:function(e){return t.$emit("item",e)}}})]}}],null,!0)})],1)}))],2)},E=[],G=s("7a7c"),z={name:"GroupItemsPanel",components:{Masonry:v["a"],ItemSelectCard:G["a"]},props:["selected","filter","price_list"],data(){return{card_class:"col-xs-6 col-sm-4 col-md-3 col-2"}},computed:{menus(){return this.$store.state.menus.s_items},m_groups(){return _.flatMap(_.pick(this.$store.state.menus.data,this.menus),(({groups:t})=>_.map(t,_.toSafeInteger)))},value(){return"group-"+(this.selected||"all")},all_items(){return this.filtered(_.uniq(_.flatMap(this.m_groups,this.groupItems)))}},methods:{groupItems(t){return this.filtered(_.uniq(_.map(_.get(this.$store.state.groups.data,[_.toSafeInteger(t),"items"]),_.toSafeInteger)))},hKey({id:t},e){return Object(c["d"])("group","items","panel",e,t)},filtered(t){return this.filter?_.intersection(t,this.filterKeys()):t},filterKeys(){return _(this.$store.state.items.data).filter((({id:t,name:e,detail:s})=>[t,e,s].join(" ").toLowerCase().includes(this.filter.toLowerCase()))).map((({id:t})=>_.toInteger(t))).value()}}},L=z,F=s("adad"),J=s("823b"),N=Object(d["a"])(L,K,E,!1,null,null,null),A=N.exports;b()(N,"components",{QTabPanels:F["a"],QTabPanel:J["a"]});var B=s("9708"),D=s("440b"),R=s("85b2"),Y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-card",[s("q-card-section",{staticClass:"bg-grey-2 row items-center"},[s("div",{staticClass:"text-bold"},[t._v("Select Menu")]),s("q-space"),s("q-btn",{directives:[{name:"show",rawName:"v-show",value:t.selected.length,expression:"selected.length"},{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-weight-bold",attrs:{round:"",icon:"clear",flat:"",color:"red-12"}})],1),s("q-list",{attrs:{separator:"",bordered:""}},t._l(t.menus,(function(e){return s("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.hKey(e),attrs:{clickable:""},on:{click:function(s){t.selected=e}}},[s("q-item-section",[s("q-item-label",[t._v(t._s(e.name))])],1),s("q-item-section",{attrs:{side:""}},[s("q-icon",{attrs:{size:"lg",name:"toggle_"+(t.is_selected(e)?"on":"off"),color:t.is_selected(e)?"positive":"grey"}})],1)],1)})),1)],1)},H=[],U=(s("ddb0"),s("ded3")),V=s.n(U),W=s("2f62"),X={name:"MenuSelect",data(){return{}},computed:V()(V()({},Object(W["d"])("menus",{menus:"data",assigned:"s_items"})),{},{selected:{get(){return this.assigned},set({id:t}){this.$store.dispatch("menus/toggle",t)}}}),methods:{is_selected({id:t}){return this.selected.includes(t)},hKey({id:t}){return Object(c["d"])("waiter","menu","select",t)}},created(){this.selected.length||1!==_.size(this.menus)||(this.selected=_.first(_.values(this.menus)))}},Z=X,tt=s("2c91"),et=s("9c40"),st=s("1c1c"),at=s("66e5"),it=s("4074"),rt=s("0170"),nt=s("0016"),lt=s("7f67"),ot=s("714f"),ct=Object(d["a"])(Z,Y,H,!1,null,null,null),ut=ct.exports;b()(ct,"components",{QCard:h["a"],QCardSection:f["a"],QSpace:tt["a"],QBtn:et["a"],QList:st["a"],QItem:at["a"],QItemSection:it["a"],QItemLabel:rt["a"],QIcon:nt["a"]}),b()(ct,"directives",{ClosePopup:lt["a"],Ripple:ot["a"]});var mt={name:"PageOrderNew",components:{MenuSelect:ut,FilterInputText:S["a"],OrderSeatingInfo:R["a"],OrderItemsSummary:D["a"],OrderCustomer:B["a"],GroupItemsPanel:A,MenuGroupTabs:P,SeatSelect:C},data(){return{tab:"seating",m_split:60,iSplit:20,pos:null,group:null,loading:!1,item_filter:"",hide:!1,r_menu:!1,params:{seating:null,price_list:null,customer:null,items:[]}}},computed:{order_info(){return this.params.seating&&this.params.items.length},split:{get(){return this.order_info&&!this.hide?this.m_split:100},set(t){this.m_split=this.order_info&&!this.hide&&100!==t?t:this.m_split}},horizontal(){let{height:t,width:e}=this.$q.screen;return null===this.pos?e<=t:this.pos},m_show:{get(){return!this.$store.state.menus.s_items.length||this.r_menu},set(t){this.r_menu=!!t}}},methods:{seat({id:t,price_list:e}){this.params.seating=t,this.params.price_list=e,this.tab="items"},item({id:t}){let e=_.find(this.params.items,["item",t]);e?e.quantity++:this.params.items.push({item:t,quantity:1,delay:0,narration:null})},quantity({item:t,quantity:e}){t=_.toSafeInteger(t),e=_.toNumber(e);let s=_.find(this.params.items,["item",t]);s?s.quantity=e:this.params.items.push({item:t,quantity:e})},remove({item:t}){let e=_.findIndex(this.params.items,["item",_.toSafeInteger(t)]);e>-1&&this.params.items.splice(e,1)},update(t){let e=_.find(this.params.items,["item",t.item]);if(!e)return null;_.forEach(_.omit(t,"item"),((t,s)=>e[s]=t))},create(){this.loading=!0,post("token","create",this.params).then((t=>{this.loading=!1,this.group=null,this.params.seating=null,this.params.customer=null,this.params.items.splice(0,this.params.items.length),this.tab="seating",this.item_filter=""}))}},created(){this.r_menu=this.m_show}},pt=mt,dt=s("9989"),ht=s("8562"),ft=s("429b"),_t=s("7460"),gt=s("eb85"),bt=s("de5e"),yt=s("24e8"),qt=Object(d["a"])(pt,a,i,!1,null,null,null);e["default"]=qt.exports,b()(qt,"components",{QPage:dt["a"],QSplitter:ht["a"],QCard:h["a"],QTabs:ft["a"],QTab:_t["a"],QSeparator:gt["a"],QTabPanels:F["a"],QTabPanel:J["a"],QBtn:et["a"],QPageSticky:bt["a"],QDialog:yt["a"]})}}]);