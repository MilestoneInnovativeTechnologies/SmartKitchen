(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[62],{"16e6":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"q-gutter-y-sm",attrs:{padding:""}},[n("ReceptionistBillSummary"),n("ReceptionistServableItems"),n("ReceptionistHomeDeliveryStatuses"),n("OnlineOrdersPendingList",{attrs:{color:"purple",title:"Pending Online Orders"}}),n("ReceptionistNonDiningTokens",{attrs:{color:"teal"}}),n("ReceptionistRemoteTokens")],1)},s=[],r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"row q-col-gutter-xs"},[n("div",{staticClass:"col-xs-6 col-md-3"},[n("DigitMetric",{attrs:{value:e.pending.length,bg:"cyan",text:"white",title:"Pending Bills",icon:"receipt"}})],1),n("div",{staticClass:"col-xs-6 col-md-3"},[n("DigitMetric",{attrs:{value:e.pending_amount,bg:"orange",text:"white",title:"Pending Amount",icon:"request_quote"}})],1),n("div",{staticClass:"col-xs-6 col-md-3"},[n("DigitMetric",{attrs:{value:e.paid.length,bg:"lime",text:"white",title:"Paid Bills",icon:"file_copy"}})],1),n("div",{staticClass:"col-xs-6 col-md-3"},[n("DigitMetric",{attrs:{value:e.paid_amount,bg:"green",text:"white",title:"Total Payments",icon:"payments"}})],1)])},a=[],o=n("84ba"),l=n("58d1"),c=n("b1c1"),d={name:"ReceptionistBillSummary",components:{DigitMetric:o["a"]},mixins:[l["a"]],computed:{today(){return _(this.bills).filter((({date:e})=>Object(c["n"])(e))).value()},pending(){return _(this.today).filter(["progress","Pending"]).value()},pending_amount(){return _.sumBy(this.pending,(({payable:e})=>_.toNumber(e)))},paid(){return _(this.today).filter((({progress:e})=>["Paid","Partial"].includes(e))).value()},paid_amount(){return _.sumBy(this.paid,(({paid:e})=>_.toNumber(e)))}}},m=d,u=n("2877"),p=Object(u["a"])(m,r,a,!1,null,null,null),g=p.exports,v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.oTokens.length?n("q-card",[n("q-card-section",{staticClass:"row justify-between text-bold text-white",class:"bg-"+e.clr},[n("div",[e._v("Non Dining Orders")]),n("div",[e._v(e._s(e.oTokens.length))])]),n("q-card-section",{staticClass:"q-pa-xs"},[n("Masonry",{attrs:{items:e.oTokens,width:"260"},scopedSlots:e._u([{key:"item",fn:function(e){return[n("OrderSummaryReceptionistOrder",{attrs:{id:e.id}})]}}],null,!1,3087263980)})],1)],1):e._e()},h=[],b=n("3758"),f=n("3b1b"),y=n("c624"),k={name:"ReceptionistNonDiningTokens",components:{Masonry:y["a"],OrderSummaryReceptionistOrder:f["a"]},mixins:[b["a"]],props:["color"],data(){return{activeProgress:["New","Processing","Completed","Billed","Pending"],displayTypes:["Take Away","Sale","Other"]}},computed:{oTokens(){return _(this.tokens).filter((({type:e,progress:t})=>this.displayTypes.includes(e)&&this.activeProgress.includes(t))).value()},clr(){return this.color||"teal"}},methods:{hKey({id:e}){return Object(c["e"])("receptionist","non","dining","token",e)}}},q=k,x=n("f09f"),w=n("a370"),C=n("eebe"),S=n.n(C),T=Object(u["a"])(q,v,h,!1,null,null,null),O=T.exports;S()(T,"components",{QCard:x["a"],QCardSection:w["a"]});var R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.items.length?n("q-card",[n("q-card-section",{staticClass:"row justify-between text-bold bg-green text-white"},[n("div",[e._v("Servable Items")]),e.items.length>0?n("div",[e._v(e._s(e.items.length))]):e._e()]),n("q-list",{attrs:{separator:"",bordered:""}},e._l(e.items,(function(t){return n("q-item",{key:"order-receptionist-servable-item-"+t.id},[n("q-item-section",[n("q-item-label",[e._v(e._s(t.quantity)+" X "+e._s(t.item?t.item.name:""))]),n("q-item-label",{attrs:{caption:""}},[n("q-icon",{attrs:{name:"outdoor_grill"}}),e._v(" "+e._s(t.kitchen?t.kitchen.name:""))],1),n("q-item-label",{attrs:{caption:""}},[n("q-icon",{attrs:{name:"event_seat"}}),e._v(" "+e._s(e.SeatingName(t.token)))],1),n("q-item-label",{staticClass:"text-bold",attrs:{caption:""}},[n("q-icon",{attrs:{name:"account_box"}}),e._v(" "+e._s(t.user?t.user.name:""))],1)],1),n("q-item-section",{attrs:{side:""}},[n("q-item-label",{attrs:{caption:""}},[e._v(e._s(e.itemTiming(t.progress_timing))+" ago")])],1),n("q-item-section",{attrs:{side:""}},[n("q-btn",{attrs:{icon:"how_to_reg",color:"positive",round:"",dense:""},on:{click:function(n){return e.served(t.id)}}})],1),e.serving.includes(t.id)?n("q-inner-loading",{attrs:{showing:!0}},[n("q-spinner-facebook",{attrs:{color:"primary",size:"2em"}})],1):e._e()],1)})),1)],1):e._e()},D=[],Q=(n("5db7"),n("73d9"),{name:"ReceptionistServableItems",mixins:[b["a"]],data(){return{now:0,serving:[]}},computed:{items(){return _.flatMap(this.tokens_own,(e=>"Dining"!==e.type?[]:_.filter(e.items,["progress","Completed"])))}},methods:{SeatingName(e){return _.get(_.find(this.tokens,["id",e]),["seating","name"])},itemTiming(e){let t=this.now-_.get(_.last(e),"time");return t<60?t+" seconds":t<3600?_.toInteger(t/60)+" minutes":_.toInteger(t/3600)+" hours"},served(e){this.serving.push(e),post("token","served",{id:e}).then((()=>this.serving=_.difference(this.serving,[e])))}},created(){setInterval((e=>e.now=_.toInteger((new Date).getTime()/1e3)),1e3,this)},watch:{items(e,t){(!t||t.length<e.length)&&Object(c["b"])()}}}),P=Q,j=n("1c1c"),I=n("66e5"),B=n("4074"),M=n("0170"),N=n("0016"),E=n("9c40"),L=n("74f7"),H=n("e669"),$=Object(u["a"])(P,R,D,!1,null,null,null),Y=$.exports;S()($,"components",{QCard:x["a"],QCardSection:w["a"],QList:j["a"],QItem:I["a"],QItemSection:B["a"],QItemLabel:M["a"],QIcon:N["a"],QBtn:E["a"],QInnerLoading:L["a"],QSpinnerFacebook:H["a"]});var A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.remote_client&&e.rTokens.length?n("q-card",[n("q-card-section",{staticClass:"bg-grey-2 row justify-between text-bold"},[n("div",[e._v("Remote Orders Statuses")]),n("div",[e._v(e._s(e.rTokens.length))])]),n("ReceptionistRecentRemoteTokensSummary",{attrs:{tokens:e.rTokens}})],1):e._e()},F=[],K=(n("498a"),n("ded3")),V=n.n(K),G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-list",{attrs:{separator:""}},e._l(e.tokens,(function(t){return n("q-expansion-item",{key:"rrrtk-t-"+t.id,attrs:{group:"one",dense:""},scopedSlots:e._u([{key:"header",fn:function(){return[n("q-item-section",[n("q-item-label",[e._v(e._s(e.to_format("D/MMM",t.date)))])],1),n("q-item-section",[n("q-item-label",[e._v(e._s(t.customer?t.customer.name:"--no-customer--"))])],1),n("q-item-section",{attrs:{side:""}},[n("q-badge",{staticClass:"q-py-xs",attrs:{color:e.tpc[e.progress(t)],label:e.progress(t)}})],1)]},proxy:!0}],null,!0)},[n("q-card",[n("q-list",{attrs:{separator:"",dense:""}},e._l(t.items,(function(i){return n("q-item",{key:"rrrtk-ti-t-"+t.id+"-ti-"+i.id+"-i-"+i.item.id},[n("q-item-section",[n("q-item-label",{attrs:{caption:""}},[e._v(e._s(e.to_format("D/MMM hh:mm A",i.deliver)))])],1),n("q-item-section",[n("q-item-label",{attrs:{caption:""}},[e._v(e._s(i.quantity)+"x "+e._s(i.item?i.item.name:"--no-item--"))])],1),n("q-item-section",{attrs:{side:""}},[n("q-badge",{staticClass:"q-py-xs",attrs:{color:e.tpc[i.progress],label:i.progress}})],1)],1)})),1)],1)],1)})),1)},J=[],z=n("232e"),U={name:"ReceptionistRecentRemoteTokensSummary",props:["tokens"],data(){return{tpc:z["TokenProgressColor"]}},computed:{},methods:{to_format:c["D"],progress({progress:e,items:t}){return"Processing"!==e?e:_.every(t,{progress:"Completed"})?"Completed":e}}},X=U,W=n("3b73"),Z=n("58a8"),ee=Object(u["a"])(X,G,J,!1,null,null,null),te=ee.exports;S()(ee,"components",{QList:j["a"],QExpansionItem:W["a"],QItemSection:B["a"],QItemLabel:M["a"],QBadge:Z["a"],QCard:x["a"],QItem:I["a"]});var ne=n("2f62");const{CC71V:ie,DP71V:se,KK99V:re}=n("adfa").FEATURES;var ae={name:"ReceptionistRemoteTokens",components:{ReceptionistRecentRemoteTokensSummary:te},mixins:[b["a"]],data(){return{remote_client:"Yes"===ie&&""!==_.trim(se)&&"Yes"===re}},computed:V()(V()({},Object(ne["b"])({progresses:"bills/token_progresses"})),{},{rTokens(){return _(this.tokens_remote).filter(oe).filter((({items:e,id:t})=>le(e)||this.not_paid(t))).sortBy(ce).value()}}),methods:{hKey({id:e}){return Object(c["e"])("receptionist","remote","token",e)},not_paid(e){return"Paid"!==_.get(this.progresses,e)}}};function oe({items:e}){return _.some(e,(({deliver:e})=>Object(c["n"])(e)||Object(c["l"])(e,3)||Object(c["k"])(e,3)))}function le(e){return _.some(e,(({progress:e})=>["New","Processing","Accepted","Completed"].includes(e)))}function ce({items:e}){return _(e).map((({deliver:e})=>Object(c["d"])(e,"YYYY-MM-DD HH:mm:ss").getTime())).min()}var de=ae,me=Object(u["a"])(de,A,F,!1,null,null,null),ue=me.exports;S()(me,"components",{QCard:x["a"],QCardSection:w["a"]});var pe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.Tokens.length||e.filter?n("q-card",[n("q-card-section",{staticClass:"bg-deep-purple text-white row justify-between text-bold items-center"},[n("div",[e._v("Home Delivery Statuses")]),n("FilterInputText",{staticClass:"gt-xs",staticStyle:{width:"50vw"},attrs:{"bg-color":"white",label:"Search"},on:{text:function(t){e.filter=t}}}),n("div",[e._v(e._s(e.Tokens.length))])],1),n("q-card-section",{staticClass:"lt-sm"},[n("FilterInputText",{attrs:{label:"Search"},on:{text:function(t){e.filter=t}}})],1),n("OrderSummaryDeliveryBoy",{attrs:{tokens:e.Tokens,kitchen:"",user:""},on:{generate:function(t){e.generating=t.id},deliver:function(t){e.delivering=t.id}}}),n("q-dialog",{attrs:{persistent:"",value:null!==e.generating},on:{hide:function(t){e.generating=null}}},[e.generating?n("BillGenerateCard",{style:e.popup_width(),attrs:{token:e.generating},on:{generated:function(t){e.generating=null}}}):e._e()],1),n("q-dialog",{attrs:{persistent:"",value:null!==e.delivering},on:{hide:function(t){e.delivering=null}}},[e.delivering?n("DeliveryBoyPaymentCard",{style:e.popup_width(),attrs:{token:e.delivering},on:{paid:function(t){e.delivering=null}}}):e._e()],1)],1):e._e()},ge=[],_e=(n("ddb0"),n("db7a")),ve=n("bf22"),he=n("1cd8"),be=n("5ab9"),fe={name:"ReceptionistHomeDeliveryStatuses",mixins:[l["a"]],components:{FilterInputText:be["a"],DeliveryBoyPaymentCard:he["a"],BillGenerateCard:ve["a"],OrderSummaryDeliveryBoy:_e["a"]},data(){return{generating:null,delivering:null,filter:""}},computed:{Tokens(){return _(this.tokens).filter(["type","Home Delivery"]).filter((({progress:e})=>!["Paid","Cancelled"].includes(e))).map((e=>e.customer?e:Object.assign({},e,{customer:z["NoCustomer"]}))).map((e=>Object.assign({},e,{slug:ye(e)}))).filter((e=>!this.filter||_.includes(e.slug,_.toLower(this.filter)))).value()},token_ids(){return _.map(this.Tokens,"id")},Bills(){return _(this.bills).filter((e=>_.includes(this.token_ids,e.token.id))).keyBy("token.id").value()}},methods:{image:c["h"],popup_width:c["x"]}};function ye(e){let t=_.pick(_.get(e,"customer"),["name","phone"]),n=_.map(_.get(e,"items"),"item.name"),i=_.get(e,["waiter","name"]);return _.toLower(_.join(_.concat(n,_.values(t),i)," "))}var ke=fe,qe=n("24e8"),xe=Object(u["a"])(ke,pe,ge,!1,null,null,null),we=xe.exports;S()(xe,"components",{QCard:x["a"],QCardSection:w["a"],QDialog:qe["a"]});var Ce=n("79d0"),Se={name:"PageReceptionistIndex",components:{OnlineOrdersPendingList:Ce["a"],ReceptionistRemoteTokens:ue,ReceptionistServableItems:Y,ReceptionistNonDiningTokens:O,ReceptionistBillSummary:g,ReceptionistHomeDeliveryStatuses:we}},Te=Se,Oe=n("9989"),Re=Object(u["a"])(Te,i,s,!1,null,null,null);t["default"]=Re.exports;S()(Re,"components",{QPage:Oe["a"]})}}]);