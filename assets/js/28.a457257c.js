(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[28],{"23ad":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("q-page",[e("FilterInputText",{staticClass:"q-ma-md",on:{text:function(e){t.filter=e}}}),e("q-list",{attrs:{separator:""}},t._l(t.showing,(function(a,s){return e("BillListItem",{key:t.hKey(a,s,"a-b-b"),class:{"bg-grey-1":s%2},attrs:{bill:a,clickable:""},nativeOn:{click:function(e){t.show=(t.selected=s,!0)}}})})),1),e("q-dialog",{attrs:{persistent:"","transition-show":"flip-down","transition-hide":"flip-up"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[t.bill?e("BillDetail",{staticStyle:{"min-width":"80vw"},attrs:{bill:t.bill},on:{print:function(e){return t.print(t.bill)},done:function(e){t.show=!1}}}):t._e()],1),e("Pagination",{attrs:{records:t.Bills,color:"teal"},model:{value:t.showing,callback:function(e){t.showing=e},expression:"showing"}})],1)},i=[],l=(a("caad"),a("58d1")),n=a("b1c1"),o=function(){var t=this,e=t._self._c;return e("q-item",t._b({},"q-item",t.$attrs,!1),[e("q-item-section",{attrs:{avatar:""}},[e("q-badge",{staticClass:"q-pa-sm",staticStyle:{"font-size":"0.65rem"},attrs:{color:"teal",label:t.bill.id}})],1),e("q-item-section",[e("q-item-label",{staticClass:"text-teal"},[t._v(t._s(t.bill.customer?t.bill.customer.name:""))]),e("q-item-label",{attrs:{caption:""}},[t._v(t._s(t.items()))]),e("q-item-label",{attrs:{caption:""}},[t._v("Token: "+t._s(t.bill.token?t.bill.token.id:"")+", Type: "+t._s(t.bill.token?t.bill.token.type:"")+", "+t._s(t.human_date(t.bill.date,!0)))])],1),e("q-item-section",{attrs:{side:""}},[e("div",{staticClass:"text-teal text-bold",staticStyle:{"font-size":"1.1rem"}},[e("span",{directives:[{name:"show",rawName:"v-show",value:"Paid"!==t.bill.progress,expression:"bill.progress !== 'Paid'"}],staticClass:"text-caption"},[t._v(t._s(t.bill.paid)+"/")]),t._v(t._s(parseFloat(t.bill.payable).toFixed(2)))])])],1)},r=[],c={name:"BillListItem",props:["bill"],methods:{human_date:n["f"],items(){return _.map(_.get(this.bill,["token","items"]),(t=>_.get(t,["item","name"]))).join(", ")}}},d=c,m=a("2877"),p=a("66e5"),b=a("4074"),u=a("58a8"),h=a("0170"),x=a("eebe"),v=a.n(x),y=Object(m["a"])(d,o,r,!1,null,null,null),q=y.exports;v()(y,"components",{QItem:p["a"],QItemSection:b["a"],QBadge:u["a"],QItemLabel:h["a"]});var g=function(){var t=this,e=t._self._c;return e("q-card",[e("q-card-section",{staticClass:"bg-teal-7 text-white",attrs:{horizontal:""}},[e("q-card-section",{staticClass:"bg-teal"},[e("div",{staticClass:"text-caption"},[t._v(t._s(t.human_date2(t.bill.date,!0)))]),e("div",{staticClass:"text-h5 text-bold"},[t._v(t._s(parseFloat(t.bill.payable).toFixed(2)))]),e("div",{staticClass:"text-caption"},[t._v("Bill ID: "+t._s(t.bill.id))]),e("div",{staticClass:"text-caption",staticStyle:{"line-height":"0.45rem"}},[t._v("Token ID: "+t._s(t.bill.token.id))])]),e("q-card-section",[e("q-badge",{staticClass:"q-mt-md q-px-lg q-py-sm",attrs:{color:"grey-1","text-color":"teal",label:t.bill.token.type}})],1),e("q-card-section",{staticClass:"col-grow text-right"},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"absolute-top-right q-mr-xs q-mt-xs",attrs:{icon:"close","text-color":"teal-1",dense:"",rounded:"",flat:""}}),e("div",{staticClass:"q-mt-xl"}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.bill.nature,expression:"bill.nature"}],staticClass:"text-caption text-italic",staticStyle:{"font-size":"0.70rem","line-height":"0.70rem"}},[t._v(t._s(t.bill.nature))]),e("div",{staticClass:"text-subtitle1",staticStyle:{"line-height":"1.1rem"}},[t._v(t._s(t.bill.customer?t.bill.customer.name:""))]),e("div",{staticClass:"text-subtitle2",staticStyle:{"font-size":"0.8rem","line-height":"1.1rem"}},[t._v(t._s(t.bill.customer?t.bill.customer.phone:""))])],1)],1),e("q-card-section",{staticClass:"row items-center justify-between q-pb-sm"},[e("div",{staticClass:"text-center text-teal text-bold",staticStyle:{"line-height":"1"}},[t._v(t._s(parseFloat(t.bill.amount).toFixed(2))),e("br"),e("span",{staticClass:"text-caption text-uppercase",staticStyle:{"font-size":"0.60rem"}},[t._v("Amount")])]),e("div",{staticClass:"text-center text-teal text-bold",staticStyle:{"line-height":"1"}},[t._v(t._s(parseFloat(t.bill.discount).toFixed(2))),e("br"),e("span",{staticClass:"text-caption text-uppercase",staticStyle:{"font-size":"0.60rem"}},[t._v("Discount")])]),e("div",{staticClass:"text-center text-teal text-bold",staticStyle:{"line-height":"1"}},[t._v(t._s(parseFloat(t.bill.payable).toFixed(2))),e("br"),e("span",{staticClass:"text-caption text-uppercase",staticStyle:{"font-size":"0.60rem"}},[t._v("Payable")])])]),e("q-list",{staticClass:"bg-grey-2",attrs:{bordered:""}},[t._l(t.bill.contents,(function(a,s){return[e("q-item",{key:"ab-dv-bc-"+s},[e("q-item-section",[e("q-item-label",{staticClass:"text-teal",staticStyle:{"font-size":"0.65rem"},attrs:{caption:""}},[t._v(t._s(parseFloat(a.price).toFixed(2)))]),e("q-item-label",[e("span",{staticClass:"text-teal text-bold"},[t._v(t._s(a.quantity)+" x ")]),t._v(t._s(a.name))])],1),e("q-item-section",[e("q-item-label",{staticStyle:{"font-size":"0.55rem"},attrs:{caption:""}},[t._v("DISCOUNT")]),e("q-item-label",[e("span",{staticClass:"text-teal text-bold"},[t._v(t._s(Math.round(parseFloat(a.discount)).toFixed(2)))])])],1),e("q-item-section",{staticClass:"text-teal text-bold text-subtitle2",attrs:{side:""}},[t._v(t._s(Math.round(parseFloat(a.quantity)*parseFloat(a.price)-parseFloat(a.discount)).toFixed(2)))])],1),a.tax&&parseFloat(a.tax.amount)>0?e("div",{staticStyle:{transform:"translateY(-0.4rem)"}},[e("div",{staticClass:"q-px-md text-grey",staticStyle:{"font-size":"0.65rem"}},[t._v("Included Tax Details"),e("br"),t._v(t._s(a.tax.name)+" - "+t._s(Math.round(parseFloat(a.tax.amount)).toFixed(2)))]),e("div",{directives:[{name:"show",rawName:"v-show",value:a.tax.contents&&a.tax.contents.length>1,expression:"content.tax.contents && content.tax.contents.length > 1"}]},t._l(a.tax.contents,(function(a,i){return e("div",{key:"abd-i-"+s+"-tc-"+i,staticClass:"q-px-xl",staticStyle:{"font-size":"0.65rem"}},[e("q-icon",{attrs:{name:"subdirectory_arrow_right"}}),t._v(" "+t._s(a.name)+" - "+t._s(Math.round(a.amount).toFixed(2)))],1)})),0)]):t._e(),e("q-separator",{staticClass:"q-mt-xs"})]}))],2),t.payments.length>0?e("q-list",{attrs:{separator:""}},[e("q-item-label",{attrs:{header:""}},[t._v("Payments")]),t._l(t.payments,(function(a,s){return e("q-item",{key:"ab-dv-b-"+t.bill.id+"-ps-"+s,staticClass:"bg-grey-2"},[e("q-item-section",{attrs:{avatar:""}},[e("q-item-label",{attrs:{caption:""}},[t._v(t._s(a.type))])],1),e("q-item-section",[e("q-item-label",{staticClass:"text-body2 text-caption"},[t._v(t._s(t.human_date2(a.date)))]),a.detail?e("q-item-label",{staticStyle:{"font-size":"0.65rem"},attrs:{caption:""}},[t._v(t._s(a.detail))]):t._e()],1),e("q-item-section",{staticClass:"text-teal text-bold text-subtitle2",attrs:{side:""}},[t._v(t._s(parseFloat(a.amount).toFixed(2)))]),e("q-item-section",{attrs:{side:""}},[e("q-icon",{staticClass:"cursor-pointer",attrs:{name:"close",color:"red",size:"xs"},on:{click:function(e){return t.payment_cancel(a)}}})],1)],1)})),e("q-item",[e("q-item-section",{attrs:{avatar:""}},[e("q-item-label",{attrs:{caption:""}},[t._v("Â ")])],1),e("q-item-section",[e("q-item-label",{staticClass:"text-body2 text-bold text-teal"},[t._v("Total Paid")])],1),e("q-item-section",{staticClass:"text-teal text-bold text-subtitle2",attrs:{side:""}},[t._v(t._s(parseFloat(t.bill.paid).toFixed(2)))]),e("q-item-section",{attrs:{side:""}},[e("q-icon",{attrs:{name:"close",color:"white",size:"xs"}})],1)],1)],2):t._e(),e("q-separator"),e("q-card-actions",{directives:[{name:"show",rawName:"v-show",value:"Cancelled"!==t.bill.progress,expression:"bill.progress !== 'Cancelled'"}],staticClass:"bg-grey-3"},[e("q-btn",{attrs:{type:"a",size:"sm",dense:"",flat:"","text-color":"red",label:"Cancel Bill"},on:{click:t.bill_cancel}}),e("q-space"),e("q-btn",{directives:[{name:"show",rawName:"v-show",value:t.bill.payable>t.bill.paid,expression:"bill.payable > bill.paid"}],attrs:{dense:"",color:"cyan",size:"sm",label:"Add Payment"},on:{click:function(e){t.add_payment=!0}}}),e("q-btn",{attrs:{dense:"",color:"teal",size:"sm",label:"Print"},on:{click:function(e){return t.$emit("print")}}})],1),e("BrowserPrintCardActions",{attrs:{bill:t.bill}}),e("q-dialog",{attrs:{persistent:"","transition-show":"zoom-in","transition-hide":"zoom-out"},model:{value:t.add_payment,callback:function(e){t.add_payment=e},expression:"add_payment"}},[e("BillPaymentAdd",{staticStyle:{"min-width":"60vw"},attrs:{bill:t.bill},on:{added:function(e){t.add_payment=!1}}})],1)],1)},f=[],C=function(){var t=this,e=t._self._c;return e("q-card",[e("q-card-section",{staticClass:"row items-center q-pa-sm bg-grey-4"},[e("q-icon",{staticClass:"q-mr-sm",attrs:{name:"account_balance"}}),e("span",[t._v("Add New Payment")]),e("q-space"),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",size:"sm",flat:"",round:"",dense:""}})],1),e("q-card-section",{staticClass:"q-gutter-y-xs"},[e("DateTime",{attrs:{dense:"",outlined:""},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}}),e("q-select",{attrs:{dense:"",outlined:"",options:t.PaymentsTypes,label:"Payment Type"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}}),e("q-input",{attrs:{dense:"",outlined:"",type:"number",label:"Amount"},model:{value:t.amount,callback:function(e){t.amount=t._n(e)},expression:"amount"}}),e("q-input",{staticStyle:{height:"5rem"},attrs:{dense:"",outlined:"",type:"textarea",label:"Details"},model:{value:t.detail,callback:function(e){t.detail=e},expression:"detail"}})],1),e("q-card-actions",{staticClass:"bg-grey-3",attrs:{align:"right"}},[e("q-btn",{attrs:{loading:t.loading,label:"Save",color:"primary",size:"sm"},on:{click:t.save}})],1)],1)},w=[],S=a("232e"),k=a("5dee"),F={name:"BillPaymentAdd",components:{DateTime:k["a"]},props:["bill"],data(){return{loading:!1,PaymentsTypes:S["PaymentsTypes"],date:"",amount:0,type:S["PaymentsTypes"][0],detail:""}},created(){this.amount=_.toNumber(this.bill.payable)-_.toNumber(this.bill.paid),this.date=Object(n["E"])("YYYY-MM-DD HH:mm:ss",new Date)},methods:{save(){this.loading=!0,post("payment","create",{bill:this.bill.id,date:this.date,amount:this.amount,type:this.type,detail:this.detail}).then(this.saved)},saved(){this.$emit("added"),this.loading=!1}}},Q=F,B=a("f09f"),P=a("a370"),z=a("0016"),I=a("2c91"),A=a("9c40"),D=a("ddd8"),T=a("27f9"),N=a("4b7e"),j=a("7f67"),O=Object(m["a"])(Q,C,w,!1,null,null,null),L=O.exports;v()(O,"components",{QCard:B["a"],QCardSection:P["a"],QIcon:z["a"],QSpace:I["a"],QBtn:A["a"],QSelect:D["a"],QInput:T["a"],QCardActions:N["a"]}),v()(O,"directives",{ClosePopup:j["a"]});var $=a("36d9"),M={name:"BillDetail",components:{BrowserPrintCardActions:$["a"],BillPaymentAdd:L},props:["bill"],data(){return{add_payment:!1}},computed:{payments(){return this.bill&&this.bill.payments.length?_.filter(this.bill.payments,["status","Active"]):[]}},methods:{human_date2:n["g"],payment_cancel({id:t}){this.$store.dispatch("payments/cancel",t,{root:!0}).then((()=>this.$emit("done")))},bill_cancel(){this.$store.dispatch("bills/cancel",this.bill,{root:!0}).then((()=>this.$emit("done")))}}},Y=M,H=a("1c1c"),J=a("eb85"),K=a("24e8"),E=Object(m["a"])(Y,g,f,!1,null,null,null),U=E.exports;v()(E,"components",{QCard:B["a"],QCardSection:P["a"],QBadge:u["a"],QBtn:A["a"],QList:H["a"],QItem:p["a"],QItemSection:b["a"],QItemLabel:h["a"],QIcon:z["a"],QSeparator:J["a"],QCardActions:N["a"],QSpace:I["a"],QDialog:K["a"]}),v()(E,"directives",{ClosePopup:j["a"]});var G=a("5ab9"),R=a("1799"),V={name:"PageArchiveBills",components:{Pagination:R["a"],FilterInputText:G["a"],BillDetail:U,BillListItem:q},mixins:[l["a"]],data(){return{selected:null,show:!1,filter:"",showing:null}},computed:{AllBills(){return _(this.bills).filter((({progress:t})=>"Cancelled"!==t)).map((t=>Object.assign({},t,{slug:W(t)}))).sortBy((({date:t})=>Object(n["d"])(t).getTime())).reverse().value()},Bills(){return this.filter?_.filter(this.AllBills,(({slug:t})=>_.includes(t,this.filter.toLowerCase()))):this.AllBills},bill(){return null===this.selected?null:this.showing[this.selected]}},methods:{hKey(t,e,a){return Object(n["e"])(a,e,t.id)},print({id:t}){post("bill","print",{id:t})}}};function W({id:t,customer:e,amount:a,token:s}){return[_.get(s,"id"),t,_.get(e,"name"),_.toNumber(a),s.type].join(" ").toLowerCase()}var X=V,Z=a("9989"),tt=Object(m["a"])(X,s,i,!1,null,null,null);e["default"]=tt.exports;v()(tt,"components",{QPage:Z["a"],QList:H["a"],QDialog:K["a"]})}}]);