(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[47],{f46e:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("q-page",[e("q-bar",{staticClass:"q-py-lg text-white",class:"bg-"+t.color},[e("q-btn",{attrs:{dense:"",flat:"",icon:"kitchen"}}),e("div",[e("q-select",{attrs:{options:Object.values(t.kitchens),"option-label":"name","option-value":"id","emit-value":"","map-options":"",borderless:"",dark:""},model:{value:t.selected_kitchen,callback:function(e){t.selected_kitchen=e},expression:"selected_kitchen"}})],1),e("q-space"),e("q-btn",{attrs:{dense:"",flat:"",icon:"Yes"===t.skd.auto_accept?"published_with_changes":"sync_problem",title:"Auto Accept - "+t.skd.auto_accept}}),e("q-btn",{attrs:{dense:"",flat:"",icon:"Yes"===t.skd.cloud?"cloud":"cloud_off",title:"Cloud - "+t.skd.cloud}}),e("q-btn",{attrs:{dense:"",flat:"",icon:"print"+(t.skd.printer?"":"_disabled"),title:t.skd.printer||"No Printer Assigned"}}),e("q-btn",{attrs:{dense:"",flat:"",icon:"notifications"+("Active"===t.skd.status?"":"_off"),title:"Status - "+t.skd.status}}),t.skd.full_timer?e("q-btn",{attrs:{dense:"",flat:"",icon:"person_pin",label:t.users[t.skd.full_timer].name,"no-caps":"",title:"Full Timer"}}):t._e(),t.skd.users&&t.skd.users.length?e("q-btn",{attrs:{dense:"",flat:"",icon:"groups",label:t.user_names(t.skd.users).join(", "),"no-caps":"",title:"Chefs"}}):t._e()],1),e("q-card",{attrs:{flat:""}},[e("q-card-section",{staticClass:"fit row",attrs:{horizontal:""}},[e("q-card-section",[e("q-card",{staticClass:"q-mt-xs"},[e("q-card-section",{staticClass:"text-white q-py-xs text-center text-caption text-bold",class:"bg-"+t.color},[t._v(t._s(t.time_now))]),e("q-list",{attrs:{dense:"",separator:""}},t._l([...t.data,...t.data2],(function(s,a){return e("q-item",{key:"kts-"+a},[e("q-item-section",[e("q-item-label",{staticClass:"text-bold",attrs:{caption:""}},[t._v(t._s(s[0]))])],1),e("q-item-section",{staticClass:"text-right text-bold",attrs:{side:""}},[t._v(t._s(s[1]))])],1)})),1),e("q-card-section",{staticClass:"text-white q-py-xs text-center text-caption text-bold",class:"bg-"+t.color})],1)],1),e("q-card-section",{staticClass:"col-grow q-pl-none"},[e("Masonry",{staticClass:"q-mt-xs",attrs:{items:t.Tokens,width:260,gutter:"xs"},scopedSlots:t._u([{key:"item",fn:function(s){return[e("transition",{attrs:{appear:"","enter-active-class":"animated zoomIn","leave-active-class":"animated zoomOut",mode:"out-in"}},[e("q-card",{key:"token-"+s.id},[e("q-card-section",{staticClass:"text-white q-py-xs flex justify-between items-center text-caption text-weight-bold",class:"bg-"+t.color},[e("div",[t._v(t._s(s.type))]),e("transition",{attrs:{appear:"","enter-active-class":"animated zoomIn text-red","leave-active-class":"animated zoomOut",mode:"out-in"}},[e("div",{key:s.progress},[t._v(t._s(s.progress))])])],1),e("q-list",{attrs:{separator:""}},t._l(s.items,(function(s){return e("q-item",{key:"token_item-"+s.id,attrs:{clickable:""}},[e("q-item-section",{attrs:{avatar:""}},[e("q-avatar",{attrs:{rounded:""}},[e("img",{attrs:{src:t.image(t.lg(s,["item","image"]))}})])],1),e("q-item-section",[e("q-item-label",[t._v(t._s(t.lg(s,"quantity"))+"x "+t._s(t.lg(s,["item","name"])))]),s.narration?e("q-item-label",{staticClass:"text-red",attrs:{caption:""}},[t._v(t._s(s.narration))]):t._e(),e("transition",{attrs:{appear:"","enter-active-class":"animated zoomIn text-"+t.color,"leave-active-class":"animated fadeOut",mode:"out-in"}},[e("q-item-label",{key:s.progress,staticClass:"text-weight-bold",attrs:{caption:""}},[t._v(t._s(s.progress))])],1),t.lg(s,["kitchen","id"])!==t.selected_kitchen?e("q-item-label",{attrs:{caption:""}},[t._v("Kitchen: "+t._s(t.lg(s,["kitchen","name"])))]):t._e()],1)],1)})),1),e("q-card-section",{staticClass:"text-white q-pa-none",class:"bg-"+t.color},[e("q-list",{attrs:{separator:"",dense:""}},[e("q-item",[e("q-item-section",{attrs:{avatar:""}},[e("q-avatar",{staticClass:"text-weight-bold"},[t._v(t._s(s.id))])],1),e("q-item-section",[s.waiter?e("q-item-label",{staticStyle:{"font-size":"0.70rem"}},[t._v("User: "+t._s(s.waiter.name))]):t._e(),s.customer?e("q-item-label",{staticStyle:{"font-size":"0.70rem"}},[t._v("Customer: "+t._s(s.customer.name))]):t._e()],1)],1)],1)],1)],1)],1)]}}])})],1)],1)],1)],1)},i=[],n=(s("caad"),s("3758")),r=s("2f62"),o=s("b1c1"),c=s("c624"),l={name:"DisplayKitchenProcessingTokens",components:{Masonry:c["a"]},mixins:[n["a"]],props:["color"],data(){return{selected_kitchen:null,time_now:"00:00:00",summary:{Tokens:"Total Tokens",tokens_new:"New Tokens",tokens_processing:"Processing Tokens",token_items:"Total Items",items_accepted:"Process Pending Items",items_processing:"Processing Items",tokens_today:"Tokens Today",token_items_processed_today:"Items Processed Today"},summary2_take:5,summary2:{items_processed:"Most processed items today",least_stock_items:"Least stock items"}}},computed:{...Object(r["d"])({kitchens:t=>t.kitchens.data,users:t=>t.users.data}),skd(){return this.selected_kitchen?_.assign({},_.get(this.kitchens,this.selected_kitchen),this.$store.state.kitchens.status[this.selected_kitchen]):{}},Tokens(){return _.filter(this.tokens,(({progress:t,items:e})=>["New","Processing"].includes(t)&&d(e,this.selected_kitchen)&&m(e,this.selected_kitchen)))},tokens_new(){return _.filter(this.Tokens,["progress","New"])},tokens_processing(){return _.filter(this.Tokens,["progress","Processing"])},token_items(){return _(this.Tokens).flatMap("items").filter((t=>_.get(t,["kitchen","id"])===this.selected_kitchen)).value()},items_accepted(){return _(this.token_items).filter(["progress","Accepted"]).value()},items_processing(){return _(this.token_items).filter(["progress","Processing"]).value()},data(){return _.map(this.summary,((t,e)=>[t,_.size(this[e])]))},tokens_today(){return _(this.tokens).filter((t=>Object(o["o"])(t.date))).filter((t=>d(t.items,this.selected_kitchen))).value()},token_items_today(){return _(this.tokens_today).flatMap("items").filter((t=>_.get(t,["kitchen","id"])===this.selected_kitchen)).value()},token_items_processed_today(){return _.filter(this.token_items_today,(t=>["Completed","Served"].includes(t.progress)))},items_processed(){return _(this.token_items_processed_today).groupBy((t=>_.get(t,["item","name"]))).mapValues((t=>_.sumBy(t,(t=>_.toNumber(t.quantity))))).map(((t,e)=>[e,t])).sortBy((t=>t[1])).reverse().value()},least_stock_items(){return _(this.$store.getters["kitchens/stock"]).map(((t,e)=>[_.get(this.$store.state.items.data,[e,"name"]),t[this.selected_kitchen]])).value()},data2(){return _(this.summary2).map(((t,e)=>_.concat([[t,""]],_.take(this[e],this.summary2_take)))).flatMap().value()}},methods:{user_names(t){return _.map(t,(t=>_.truncate(_.get(this.users,[t,"name"]),{length:5,omission:".."})))},lg:_.get,image:o["i"]},created(){setInterval((t=>t.time_now=(new Date).toTimeString().split(" ")[0]),1e3,this)}};function d(t,e){return _.some(t,(t=>_.get(t,["kitchen","id"])===e))}function m(t,e){return _(t).filter((t=>["Accepted","Processing"].includes(t.progress))).filter((t=>_.get(t,["kitchen","id"])===e)).size()>0}var u=l,p=s("2877"),k=s("9989"),h=s("d847"),g=s("9c40"),f=s("ddd8"),q=s("2c91"),b=s("f09f"),v=s("a370"),y=s("1c1c"),x=s("66e5"),w=s("4074"),C=s("0170"),T=s("cb32"),P=s("eebe"),Q=s.n(P),I=Object(p["a"])(u,a,i,!1,null,null,null);e["default"]=I.exports;Q()(I,"components",{QPage:k["a"],QBar:h["a"],QBtn:g["a"],QSelect:f["a"],QSpace:q["a"],QCard:b["a"],QCardSection:v["a"],QList:y["a"],QItem:x["a"],QItemSection:w["a"],QItemLabel:C["a"],QAvatar:T["a"]})}}]);